---
title: "Creating WSAF matrix for coiaf"
author: "OJ Watson"
date: "`r format(Sys.time(), '%B %d, %Y')`"
output:
  prettydoc::html_pretty:
    theme: cayman
    highlight: vignette
    toc: true
    fig_caption: yes
editor_options: 
  chunk_output_type: console
---

```{r imports, echo=F, warning=F, message=F, results='hide'}
library(tidyverse)
library(RColorBrewer)
library(devtools)
library(here)
library(rslurm)
library(vcfR)
devtools::install_github("OJWatson/McCOILR")
```

This script uses the filtered VCF from after step 4 in 00_Pf6k_vcf_download_loci_selection:

1. Download the Pf6k VCFs
2. Filter to quality, biallelic SNPs
3. Subset to samples that pass Pf6k inclusion
4. Identify suitable subregions to group samples into 
5. Identify loci that have MAF > 0.05 globally and regionally
6. Filter to sets of loci that are not in linkage disequilbirium
7. Resultant loci are converted into homo/het calls
8. Homo/het calls for each region are sent to RMCL for COI
9. Summary estimates of COI are estimated for each sample
