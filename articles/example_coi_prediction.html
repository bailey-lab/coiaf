<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Example COI Prediction • coiaf</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Example COI Prediction">
<meta property="og:description" content="coiaf">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">coiaf</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="..//index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/sensitivity_analysis.html">Sensitivity Αnalysis</a>
    </li>
    <li>
      <a href="../articles/example_real_data.html">Real Data</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/example_coi_prediction.html">COI Prediction</a>
    </li>
    <li>
      <a href="../articles/example_simulation.html">Simulation Example</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ojwatson/coiaf/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="example_coi_prediction_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Example COI Prediction</h1>
                        <h4 class="author">Aris Paschalidis</h4>
            
            <h4 class="date">July 2020</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ojwatson/coiaf/blob/master/vignettes/example_coi_prediction.Rmd"><code>vignettes/example_coi_prediction.Rmd</code></a></small>
      <div class="hidden name"><code>example_coi_prediction.Rmd</code></div>

    </div>

    
    
<p>In this analysis the two COI estimation methods are demonstrated. In these we will simulate 1000 loci for an individual. We first initialize the population level allele frequency (PLAF) using a beta distribution.</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="co"># Set seed</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">1</span>)

<span class="co"># Define the number of loci and the distribution of minor allele frequencies</span>
<span class="kw">L</span> <span class="op">&lt;-</span> <span class="fl">1e3</span>
<span class="kw">p</span> <span class="op">&lt;-</span> <span class="kw">stats</span>::<span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">rbeta</a></span>(<span class="kw">L</span>, <span class="fl">1</span>, <span class="fl">5</span>)
<span class="kw">p</span>[<span class="kw">p</span> <span class="op">&gt;</span> <span class="fl">0.5</span>] <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="kw">p</span>[<span class="kw">p</span> <span class="op">&gt;</span> <span class="fl">0.5</span>]
</pre></div>
<div id="method-1" class="section level1">
<h1 class="hasAnchor">
<a href="#method-1" class="anchor"></a>Method 1</h1>
<p>The first approach in the manuscript document for estimating COI is shown below. This works by using the mean number of variant sites, binned in groups of increasing PLAF to infer COI.</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="co"># Loop over range of COIs </span>
<span class="kw">end_coi</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>()
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(mar=<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(mfrow = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>,<span class="fl">2</span>))
<span class="co">for</span> (<span class="kw">k</span> <span class="co">in</span> <span class="fl">2</span><span class="op">:</span><span class="fl">7</span>){

  <span class="co"># Simulate data and subset to heterozygous sites only</span>
  <span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">1</span>)
  <span class="kw">sim1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_biallelic.html">sim_biallelic</a></span>(COI = <span class="kw">k</span>, PLAF = <span class="kw">p</span>)

  <span class="co"># Plot raw WSAF as gray dots</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span>(<span class="kw">sim1</span><span class="op">$</span><span class="kw">data</span><span class="op">$</span><span class="kw">PLAF</span>, <span class="kw">sim1</span><span class="op">$</span><span class="kw">data</span><span class="op">$</span><span class="kw">WSAF</span>, 
       pch = <span class="fl">20</span>, cex = <span class="fl">0.5</span>, col = <span class="st">"gray"</span>, ylim = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">1</span>),
       xlab = <span class="st">"PLAF"</span>, ylab = <span class="st">"WSAF"</span>, main = <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"COI ="</span>, <span class="kw">k</span>))

  <span class="co"># Overlay analytical expectations for COI of 2:7</span>
  <span class="kw">p_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0</span>, <span class="fl">0.5</span>, l=<span class="fl">101</span>)
  <span class="kw">theory_cois</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/theoretical_coi.html">theoretical_coi</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">1</span>, <span class="fl">7</span>), <span class="kw">p_vec</span>)
  <span class="co">for</span> (<span class="kw">i</span> <span class="co">in</span> <span class="fl">2</span><span class="op">:</span><span class="fl">7</span>) {
    <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="kw">p_vec</span>, <span class="kw">theory_cois</span>[[<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"coi_"</span>, <span class="kw">i</span>, sep = <span class="st">""</span>)]], 
          col = <span class="st">"red"</span>, lwd = <span class="fl">2</span>)
  }
  <span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span>(x = <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0.505</span>, <span class="fl">6</span>), y = <span class="fl">1</span> <span class="op">-</span> <span class="fl">0.5</span><span class="op">^</span>(<span class="fl">1</span><span class="op">:</span><span class="fl">6</span>), labels = <span class="fl">2</span><span class="op">:</span><span class="fl">7</span>, 
       col = <span class="st">"red"</span>, cex = <span class="fl">0.6</span>)

  <span class="co"># Compute windowed averages over WSAF and overlay in blue</span>
  <span class="kw">cut</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0</span>,<span class="fl">0.5</span>,<span class="fl">0.01</span>)
  <span class="kw">df_grouped</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/process_simulated_coi.html">process_simulated_coi</a></span>(<span class="kw">sim1</span>, <span class="fl">0.01</span>, <span class="kw">cut</span>)

  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="kw">df_grouped</span><span class="op">$</span><span class="kw">midpoints</span>, <span class="kw">df_grouped</span><span class="op">$</span><span class="kw">m_true_variant</span>, 
        col = <span class="st">"blue"</span>, lwd = <span class="fl">2</span>, type = <span class="st">"o"</span>, pch = <span class="fl">20</span>)
  
  <span class="co"># Predict the COI and print the results</span>
  <span class="kw">calc_coi</span> <span class="op">=</span> <span class="fu"><a href="../reference/compute_coi.html">compute_coi</a></span>(<span class="kw">df_grouped</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">1</span>, <span class="fl">7</span>), <span class="kw">cut</span>, <span class="st">"overall"</span>, <span class="st">"squared"</span>, <span class="fl">TRUE</span>)
  <span class="kw">end_coi</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">end_coi</span>, <span class="kw">calc_coi</span><span class="op">$</span><span class="kw">coi</span>))
}
</pre></div>
<p><img src="example_coi_prediction_files/figure-html/method%201-1.png" width="700"></p>
<p>In this the intercept at <code>PLAF = 0.5</code> gives us an easy way to estimate COI, with <code>COI = 1 + log_0.5(1-WSAF)</code>, or <code>WSAF = 1 - 0.5^(COI-1)</code>. However, the differences between each COI at PLAF = 0.5 become geometrically smaller. Larger gaps can be found at different COI, with smaller PLAF:</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="co">## Best place to calculate COI:</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(mar=<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(mfrow = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>,<span class="fl">3</span>))
<span class="kw">p_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0</span>, <span class="fl">0.5</span>, l=<span class="fl">101</span>)
<span class="kw">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>()
<span class="co">for</span> (<span class="kw">k</span> <span class="co">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>) {
  <span class="kw">y</span>[[<span class="kw">k</span>]] <span class="op">&lt;-</span> <span class="fu"><a href="../reference/theoretical_coi.html">theoretical_coi</a></span>(<span class="kw">k</span>, <span class="kw">p_vec</span>)[[<span class="fl">1</span>]]

  <span class="co">if</span>(<span class="kw">k</span><span class="op">&gt;</span><span class="fl">1</span>) {
   <span class="kw">new_y</span> <span class="op">&lt;-</span> <span class="kw">y</span>[[<span class="kw">k</span>]]<span class="op">-</span><span class="kw">y</span>[[<span class="kw">k</span><span class="op">-</span><span class="fl">1</span>]]
   <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span>(<span class="kw">p_vec</span>, <span class="kw">new_y</span>,
        ylab = <span class="st">"Difference between Proportion Variant for k and k-1"</span>,
        xlab = <span class="st">"Population MAF"</span>,
        main = <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"COI = "</span>, <span class="kw">k</span>))
   <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(v=<span class="kw">p_vec</span>[<span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.max</a></span>(<span class="kw">new_y</span>)], lty = <span class="fl">2</span>)
   <span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span>(x=<span class="kw">p_vec</span>[<span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.max</a></span>(<span class="kw">new_y</span>)] <span class="op">-</span> <span class="fl">0.02</span>, y = <span class="fl">0.0</span>, 
        labels = <span class="kw">p_vec</span>[<span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.max</a></span>(<span class="kw">new_y</span>)])
  }
}
</pre></div>
<p><img src="example_coi_prediction_files/figure-html/ideal%20PLAF-1.png" width="700"></p>
</div>
<div id="method-2" class="section level1">
<h1 class="hasAnchor">
<a href="#method-2" class="anchor"></a>Method 2</h1>
<p>In method 2, we plot WSAF against PLAF for only the sites that are heterogeneous, i.e. not all REF or ALT calls.</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="co"># loop over range of COIs</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(mar=<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(mfrow = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>,<span class="fl">2</span>))
<span class="co">for</span> (<span class="kw">k</span> <span class="co">in</span> <span class="fl">2</span><span class="op">:</span><span class="fl">7</span>) {

  <span class="co"># simulate data and subset to heterozygous sites only</span>
  <span class="co"># set.seed(1)</span>
  <span class="kw">sim1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_biallelic.html">sim_biallelic</a></span>(COI = <span class="kw">k</span>, PLAF = <span class="kw">p</span>, overdispersion = <span class="fl">0.01</span>)
  <span class="kw">sim1</span><span class="op">$</span><span class="kw">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span>(<span class="kw">sim1</span><span class="op">$</span><span class="kw">data</span>, <span class="kw">WSAF</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="kw">WSAF</span> <span class="op">&lt;</span> <span class="fl">1</span>)

  <span class="co"># plot raw WSAF as grey dots</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span>(<span class="kw">sim1</span><span class="op">$</span><span class="kw">data</span><span class="op">$</span><span class="kw">PLAF</span>, <span class="kw">sim1</span><span class="op">$</span><span class="kw">data</span><span class="op">$</span><span class="kw">WSAF</span>, pch = <span class="fl">20</span>, cex = <span class="fl">0.5</span>, col = <span class="st">"gray"</span>, 
       ylim = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">1</span>), xlab = <span class="st">"PLAF"</span>, ylab = <span class="st">"WSAF"</span>, main = <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"COI ="</span>, <span class="kw">k</span>))

  <span class="co"># overlay analytical expectations for COI=2:7</span>
  <span class="kw">p_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0</span>, <span class="fl">0.5</span>, l=<span class="fl">101</span>)
  <span class="kw">theory_cois</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/theoretical_coi.html">theoretical_coi</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">1</span>, <span class="fl">7</span>), <span class="kw">p_vec</span>, method = <span class="st">"2"</span>)
  <span class="co">for</span> (<span class="kw">i</span> <span class="co">in</span> <span class="fl">2</span><span class="op">:</span><span class="fl">7</span>) {
    <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="kw">p_vec</span>, <span class="kw">theory_cois</span>[[<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"coi_"</span>, <span class="kw">i</span>, sep = <span class="st">""</span>)]], col = <span class="fl">2</span>, lwd = <span class="fl">2</span>)
  }
  <span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span>(x = <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="op">-</span><span class="fl">0.005</span>, <span class="fl">6</span>), y = <span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">:</span><span class="fl">7</span>, labels = <span class="fl">2</span><span class="op">:</span><span class="fl">7</span>, col = <span class="st">"red"</span>, cex = <span class="fl">0.6</span>)

  <span class="co"># compute sliding-window averages over WSAF and overlay in blue</span>
  <span class="kw">cut_breaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">0.025</span>)
  <span class="kw">cut_mids</span> <span class="op">&lt;-</span> <span class="kw">cut_breaks</span>[<span class="op">-</span><span class="fl">1</span>]<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span>(<span class="kw">cut_breaks</span>)<span class="op">/</span><span class="fl">2</span>
  <span class="kw">c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span>(<span class="kw">sim1</span><span class="op">$</span><span class="kw">data</span><span class="op">$</span><span class="kw">PLAF</span>, breaks = <span class="kw">cut_breaks</span>)
  <span class="kw">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mapply.html">mapply</a></span>(<span class="kw">mean</span>, <span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span>(<span class="kw">sim1</span><span class="op">$</span><span class="kw">data</span><span class="op">$</span><span class="kw">WSAF</span>, f = <span class="kw">c</span>))
  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="kw">cut_mids</span>, <span class="kw">x2</span>, col = <span class="st">"blue"</span>, lwd = <span class="fl">2</span>, type = <span class="st">"o"</span>, pch = <span class="fl">20</span>)
}
</pre></div>
<p><img src="example_coi_prediction_files/figure-html/method%202-1.png" width="700"></p>
<p>In this case, COI is found as 1/WSAF when PLAF = 0 (i.e. the y-axis intercept).</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Aris Paschalidis, OJ Watson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
