[{"path":"https://bailey-lab.github.io/coiaf/dev/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2021 coiaf authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Aris Paschalidis. Author, maintainer. OJ Watson. Author.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Paschalidis , Watson O (2021). coiaf: Complexity Infection Estimation Allele Frequencies. https://bailey-lab.github.io/coiaf/, https://github.com/bailey-lab/coiaf.","code":"@Manual{,   title = {coiaf: Complexity of Infection Estimation with Allele Frequencies},   author = {Aris Paschalidis and OJ Watson},   year = {2021},   note = {https://bailey-lab.github.io/coiaf/, https://github.com/bailey-lab/coiaf}, }"},{"path":[]},{"path":"https://bailey-lab.github.io/coiaf/dev/index.html","id":"introduction","dir":"","previous_headings":"","what":"Introduction","title":"Complexity of Infection Estimation with Allele Frequencies","text":"malaria, individuals often infected different parasite strains, complexity infection (COI) giving number genetically different parasite strains individual. Changes mean COI population shown informative changes transmission intensity number probabilistic likelihood Bayesian models now developed estimate COI. However, rapid, direct measures based heterozygosity FwS directly related COI. package present two new methods use easily calculated measures directly estimate COI sequence read depth data.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Complexity of Infection Estimation with Allele Frequencies","text":"may install package Github using devtools. may either install recent release development version software.","code":"# install.packages(\"devtools\")  # Most recent release devtools::install_github(\"bailey-lab/coiaf@v0.1.0\")  # Development version devtools::install_github(\"bailey-lab/coiaf\")"},{"path":"https://bailey-lab.github.io/coiaf/dev/index.html","id":"usage","dir":"","previous_headings":"","what":"Usage","title":"Complexity of Infection Estimation with Allele Frequencies","text":"Please consult example real data vignette primer run real data using coiaf. description estimation methods work, please consult example coi prediction vignette.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/index.html","id":"development","dir":"","previous_headings":"Usage","what":"Development","title":"Complexity of Infection Estimation with Allele Frequencies","text":"Please note package still development may missing features.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/coiaf-package.html","id":null,"dir":"Reference","previous_headings":"","what":"coiaf: Complexity of Infection Estimation with Allele Frequencies — coiaf-package","title":"coiaf: Complexity of Infection Estimation with Allele Frequencies — coiaf-package","text":"Provides direct method estimating complexity infection using easily calculated measures sequence read depth data.","code":""},{"path":[]},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/coiaf-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"coiaf: Complexity of Infection Estimation with Allele Frequencies — coiaf-package","text":"Maintainer: Aris Paschalidis aris_paschalidis@brown.edu (ORCID) Authors: OJ Watson oj.watson@hotmail.co.uk (ORCID)","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/compute_coi.html","id":null,"dir":"Reference","previous_headings":"","what":"Predict the COI — compute_coi","title":"Predict the COI — compute_coi","text":"Predict COI sample.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/compute_coi.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predict the COI — compute_coi","text":"","code":"compute_coi(   data,   data_type,   max_coi = 25,   seq_error = NULL,   bin_size = 20,   comparison = \"overall\",   distance = \"squared\",   coi_method = \"variant\" )"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/compute_coi.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predict the COI — compute_coi","text":"data data COI computed. data_type type data analyzed. One \"sim\" \"real\". max_coi number indicating maximum COI compare simulated data . seq_error level sequencing error assumed. value inputted, infer level sequence error. bin_size minimum size bin data. comparison method employed. One \"end\", \"ideal\", \"overall\". distance distance method used determine distance theoretical simulated curves \"overall\" method. One \"abs_sum\", \"sum_abs\", \"squared\". coi_method method use calculate theoretical COI. method either \"variant\" \"frequency\". default value \"variant\".","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/compute_coi.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Predict the COI — compute_coi","text":"list following: coi: predicted COI sample. probability: probability density function representing probability COI.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/compute_coi.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Predict the COI — compute_coi","text":"Compare within sample allele frequency (WSAF) population level allele frequency (PLAF) sample theoretical WSAF PLAF look like. examining sample's WSAF PLAF theoretical WSAF PLAF, estimation can made COI sample . refer sample's WSAF vs PLAF \"sample curve\" refer theoretical WSAF vs PLAF \"theoretical curve.\" determine predicted COI value, one three different methods can selected: end Determines distance theoretical sample curve PLAF 0.5. COI whichever theoretical COI curve smallest distance simulated data. ideal Determines distance theoretical sample curve ideal PLAF. ideal PLAF calculated looking change COI \\(\\) COI \\(-1\\) finding PLAF distance maximized. COI whichever theoretical COI curve smallest distance simulated data ideal PLAF. overall Determines distance theoretical simulated curve PLAFs. Computes distance theoretical curves simulated curve. COI whichever theoretical curve smallest distance simulated curve. option choose one several distance metrics: abs_sum: Absolute value sum difference. sum_abs: Sum absolute difference. squared: Sum squared difference.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/cont_sensitivity.html","id":null,"dir":"Reference","previous_headings":"","what":"Continuous sensitivity analysis — cont_sensitivity","title":"Continuous sensitivity analysis — cont_sensitivity","text":"Runs several iterations full COI sensitivity analysis varying parameters.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/cont_sensitivity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Continuous sensitivity analysis — cont_sensitivity","text":"","code":"cont_sensitivity(   repetitions = 10,   coi = 3,   max_coi = 25,   plaf = runif(1000, 0, 0.5),   coverage = 200,   alpha = 1,   overdispersion = 0,   relatedness = 0,   epsilon = 0,   seq_error = NULL,   bin_size = 20,   comparison = \"overall\",   distance = \"squared\",   coi_method = \"variant\" )"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/cont_sensitivity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Continuous sensitivity analysis — cont_sensitivity","text":"repetitions number times sample run. coi Complexity infection. max_coi number indicating maximum COI compare simulated data . plaf Vector population-level allele frequencies locus. coverage Coverage locus. single value coverage applied loci. alpha Shape parameter symmetric Dirichlet prior strain proportions. overdispersion extent counts -dispersed relative binomial distribution. Counts Beta-binomially distributed, beta distribution shape parameters \\(\\frac{p}{overdispersion}\\) \\(\\frac{1-p}{overdispersion}\\). relatedness probability strain mixed infections related another. Default = 0 (unrelated). implementation similar relatedness defined REAL McCOIL simulations. original paper (https://doi.org/10.1371/journal.pcbi.1005348) defined : \"... simulated relatedness (r) among lineages within host sampling alleles either existing lineage within host (probability r) population (probability (1-r)).\" epsilon probability single read miscalled allele. Applies directions. seq_error level sequencing error assumed. value inputted, infer level sequence error. bin_size minimum size bin data. comparison method employed. One \"end\", \"ideal\", \"overall\". distance distance method used determine distance theoretical simulated curves \"overall\" method. One \"abs_sum\", \"sum_abs\", \"squared\". coi_method method use calculate theoretical COI. method either \"variant\" \"frequency\". default value \"variant\".","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/cont_sensitivity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Continuous sensitivity analysis — cont_sensitivity","text":"list following: predicted_coi: dataframe predicted COIs. COIs predicted using compute_coi(). column represents separate set parameters. row represents predicted COI. Predictions done many times, depending value repetitions. probability:list matrices containing probability model predicted COI value. row contains probability different run. first row contains average probabilities runs. param_grid: parameter grid. parameter grid possible combinations parameters inputted. row represents unique combination. boot_error: dataframe containing information error algorithm. first column indicates COI fed simulation. columns indicate mean absolute error (mae), lower upper bounds 95% confidence interval bias.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/distance_curves.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute distance between two curves — distance_curves","title":"Compute distance between two curves — distance_curves","text":"Compute distance two curves using several methods. abs_sum Absolute value sum difference. sum_abs Sum absolute difference. squared Sum squared difference.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/distance_curves.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute distance between two curves — distance_curves","text":"","code":"distance_curves(processed_data, theory_cois, distance = \"squared\")"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/distance_curves.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute distance between two curves — distance_curves","text":"theory_cois theoretical COI curves. distance distance method used determine distance theoretical simulated curves \"overall\" method. One \"abs_sum\", \"sum_abs\", \"squared\".","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/distance_curves.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute distance between two curves — distance_curves","text":"list following: coi predicted COI simulation. dist distance theoretical COI simulated COI curve.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/error_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Error plot — error_plot","title":"Error plot — error_plot","text":"Creates plot showing error sensitivity analysis.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/error_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Error plot — error_plot","text":"","code":"error_plot(   data,   fill = \"coi\",   fill_levels = NULL,   title = NULL,   legend_title = fill,   legend.position = \"right\",   second_fill = NULL )"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/error_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Error plot — error_plot","text":"data data plotted. fill variable data separated . fill_levels levels fill variable. title title plot. Default NULL. legend_title text legend. Default NULL. legend.position position legend. One \"none\", \"left\", \"right\", \"bottom\", \"top\". second_fill Indicates second fill variable .","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/error_plot.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Error plot — error_plot","text":"function takes output sensitivity(). Plots created using ggplot2::geom_col(), creates simple bar plot. mean absolute error plotted various colors, according parameter tested. addition 95% confidence interval shown black vertical lines.","code":""},{"path":[]},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/example_real_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Example real data — example_real_data","title":"Example real data — example_real_data","text":"small example dataset contains within-sample allele frequencies (WSAFs) sample individuals.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/example_real_data.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Example real data — example_real_data","text":"matrix data. rows matrix indicate sample name columns matrix indicate WSAF locus.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/example_real_data.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Example real data — example_real_data","text":"ftp://ngs.sanger.ac.uk/production/malaria/pfcommunityproject/Pf6/","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/likelihood.html","id":null,"dir":"Reference","previous_headings":"","what":"Likelihood of a COI — likelihood","title":"Likelihood of a COI — likelihood","text":"function generate likelihood specific COI value.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/likelihood.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Likelihood of a COI — likelihood","text":"","code":"likelihood(coi, processed_data, distance = \"squared\", coi_method = \"variant\")"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/likelihood.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Likelihood of a COI — likelihood","text":"coi COI likelihood generated. processed_data processed COI data. output process_sim() process_real(). distance distance method used determine distance theoretical simulated curves \"overall\" method. One \"abs_sum\", \"sum_abs\", \"squared\". coi_method method use calculate theoretical COI. method either \"variant\" \"frequency\". default value \"variant\".","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/likelihood.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Likelihood of a COI — likelihood","text":"likelihood specific COI value.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/likelihood.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Likelihood of a COI — likelihood","text":"likelihood can thought distance two curves: \"real\" COI curve, generated inputted data, \"simulated\" COI curve, depends COI value specified. three different methods implemented compute distance two curves: abs_sum: Absolute value sum difference. sum_abs: Sum absolute difference. squared: Sum squared difference.","code":""},{"path":[]},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/optimize_coi.html","id":null,"dir":"Reference","previous_headings":"","what":"Optimize the COI — optimize_coi","title":"Optimize the COI — optimize_coi","text":"function compute COI inputted data.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/optimize_coi.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Optimize the COI — optimize_coi","text":"","code":"optimize_coi(   data,   data_type,   max_coi = 25,   seq_error = NULL,   bin_size = 20,   distance = \"squared\",   coi_method = \"variant\" )"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/optimize_coi.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Optimize the COI — optimize_coi","text":"data data COI computed. data_type type data analyzed. One \"sim\" \"real\". max_coi number indicating maximum COI compare simulated data . seq_error level sequencing error assumed. value inputted, infer level sequence error. bin_size minimum size bin data. distance distance method used determine distance theoretical simulated curves \"overall\" method. One \"abs_sum\", \"sum_abs\", \"squared\". coi_method method use calculate theoretical COI. method either \"variant\" \"frequency\". default value \"variant\".","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/optimize_coi.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Optimize the COI — optimize_coi","text":"predicted COI value.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/optimize_coi.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Optimize the COI — optimize_coi","text":"function utilizes stats::optim() particular, function utilizes quasi-Newton method compute gradients build picture surface optimized. function uses likelihood function defined likelihood().","code":""},{"path":[]},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/pipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipe operator — %>%","title":"Pipe operator — %>%","text":"See magrittr::%>% details.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/pipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipe operator — %>%","text":"","code":"lhs %>% rhs"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/process.html","id":null,"dir":"Reference","previous_headings":"","what":"Process data — process","title":"Process data — process","text":"Helper function process data","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/process.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Process data — process","text":"","code":"process(wsaf, plaf, seq_error = NULL, bin_size = 20, coi_method = \"variant\")"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/process.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Process data — process","text":"wsaf within-sample allele frequency. plaf population-level allele frequency. seq_error level sequencing error assumed. value inputted, infer level sequence error. bin_size minimum size bin data. coi_method method use calculate theoretical COI. method either \"variant\" \"frequency\". default value \"variant\".","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/process.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Process data — process","text":"list following: data: tibble plaf_cut: Breaks form [, b). m_variant: average WSAF proportion variant sites segment defined plaf_cut. bucket_size: number loci bucket. midpoints: midpoint bucket. seq_error: sequence error inferred. bin_size: minimum size bin. cuts: breaks utilized splitting data. COI.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/process.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Process data — process","text":"function computes whether SNP variant site , based simulated WSAF SNP. process additionally accounts potential sequencing error.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/process_real.html","id":null,"dir":"Reference","previous_headings":"","what":"Process real data — process_real","title":"Process real data — process_real","text":"Generate COI curve real data.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/process_real.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Process real data — process_real","text":"","code":"process_real(   wsaf,   plaf,   seq_error = NULL,   bin_size = 20,   coi_method = \"variant\" )"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/process_real.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Process real data — process_real","text":"wsaf within-sample allele frequency. plaf population-level allele frequency. seq_error level sequencing error assumed. value inputted, infer level sequence error. bin_size minimum size bin data. coi_method method use calculate theoretical COI. method either \"variant\" \"frequency\". default value \"variant\".","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/process_real.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Process real data — process_real","text":"list following: data: tibble plaf_cut: Breaks form [, b). m_variant: average WSAF proportion variant sites segment defined plaf_cut. bucket_size: number loci bucket. midpoints: midpoint bucket. seq_error: sequence error inferred. bin_size: minimum size bin. cuts: breaks utilized splitting data. COI.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/process_real.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Process real data — process_real","text":"function computes whether SNP variant site , based simulated WSAF SNP. process additionally accounts potential sequencing error.","code":""},{"path":[]},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/process_sim.html","id":null,"dir":"Reference","previous_headings":"","what":"Process simulated data — process_sim","title":"Process simulated data — process_sim","text":"Generate simulated COI curve.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/process_sim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Process simulated data — process_sim","text":"","code":"process_sim(sim, seq_error = NULL, bin_size = 20, coi_method = \"variant\")"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/process_sim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Process simulated data — process_sim","text":"sim Output sim_biallelic(). seq_error level sequencing error assumed. value inputted, infer level sequence error. bin_size minimum size bin data. coi_method method use calculate theoretical COI. method either \"variant\" \"frequency\". default value \"variant\".","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/process_sim.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Process simulated data — process_sim","text":"list following: data: tibble plaf_cut: Breaks form [, b). m_variant: average WSAF proportion variant sites segment defined plaf_cut. bucket_size: number loci bucket. midpoints: midpoint bucket. seq_error: sequence error inferred. bin_size: minimum size bin. cuts: breaks utilized splitting data. COI.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/process_sim.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Process simulated data — process_sim","text":"Utilize output sim_biallelic(), creates simulated data. PLAF kept, function computes whether SNP variant site , based simulated WSAF SNP. process additionally accounts potential sequencing error. check whether simulated WSAF correctly indicated variant site , phased haplotype parasites computed.","code":""},{"path":[]},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/rbetabinom.html","id":null,"dir":"Reference","previous_headings":"","what":"Draw from Beta-binomial distribution — rbetabinom","title":"Draw from Beta-binomial distribution — rbetabinom","text":"Draw Beta-binomial distribution.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/rbetabinom.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Draw from Beta-binomial distribution — rbetabinom","text":"","code":"rbetabinom(n = 1, k = 10, alpha = 1, beta = 1)"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/rbetabinom.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Draw from Beta-binomial distribution — rbetabinom","text":"n Number draws. k Number binomial trials. alpha First shape parameter beta distribution. beta Second shape parameter beta distribution.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/rdirichlet.html","id":null,"dir":"Reference","previous_headings":"","what":"Draw from Dirichlet distribution — rdirichlet","title":"Draw from Dirichlet distribution — rdirichlet","text":"Draw Dirichlet distribution given vector shape parameters.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/rdirichlet.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Draw from Dirichlet distribution — rdirichlet","text":"","code":"rdirichlet(shape = rep(1, 3))"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/rdirichlet.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Draw from Dirichlet distribution — rdirichlet","text":"shape Vector shape parameters.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/sensitivity.html","id":null,"dir":"Reference","previous_headings":"","what":"Sensitivity analysis — sensitivity","title":"Sensitivity analysis — sensitivity","text":"Runs several iterations full COI sensitivity analysis varying parameters.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/sensitivity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sensitivity analysis — sensitivity","text":"","code":"sensitivity(   repetitions = 10,   coi = 3,   max_coi = 25,   plaf = runif(1000, 0, 0.5),   coverage = 200,   alpha = 1,   overdispersion = 0,   relatedness = 0,   epsilon = 0,   seq_error = NULL,   bin_size = 20,   comparison = \"overall\",   distance = \"squared\",   coi_method = \"variant\" )"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/sensitivity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sensitivity analysis — sensitivity","text":"repetitions number times sample run. coi Complexity infection. max_coi number indicating maximum COI compare simulated data . plaf Vector population-level allele frequencies locus. coverage Coverage locus. single value coverage applied loci. alpha Shape parameter symmetric Dirichlet prior strain proportions. overdispersion extent counts -dispersed relative binomial distribution. Counts Beta-binomially distributed, beta distribution shape parameters \\(\\frac{p}{overdispersion}\\) \\(\\frac{1-p}{overdispersion}\\). relatedness probability strain mixed infections related another. Default = 0 (unrelated). implementation similar relatedness defined REAL McCOIL simulations. original paper (https://doi.org/10.1371/journal.pcbi.1005348) defined : \"... simulated relatedness (r) among lineages within host sampling alleles either existing lineage within host (probability r) population (probability (1-r)).\" epsilon probability single read miscalled allele. Applies directions. seq_error level sequencing error assumed. value inputted, infer level sequence error. bin_size minimum size bin data. comparison method employed. One \"end\", \"ideal\", \"overall\". distance distance method used determine distance theoretical simulated curves \"overall\" method. One \"abs_sum\", \"sum_abs\", \"squared\". coi_method method use calculate theoretical COI. method either \"variant\" \"frequency\". default value \"variant\".","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/sensitivity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sensitivity analysis — sensitivity","text":"list following: predicted_coi: dataframe predicted COIs. COIs predicted using compute_coi(). column represents separate set parameters. row represents predicted COI. Predictions done many times, depending value repetitions. probability:list matrices containing probability model predicted COI value. row contains probability different run. first row contains average probabilities runs. param_grid: parameter grid. parameter grid possible combinations parameters inputted. row represents unique combination. boot_error: dataframe containing information error algorithm. first column indicates COI fed simulation. columns indicate mean absolute error (mae), lower upper bounds 95% confidence interval bias.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/sensitivity_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Sensitivity plot — sensitivity_plot","title":"Sensitivity plot — sensitivity_plot","text":"Creates plot sensitivity analysis.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/sensitivity_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sensitivity plot — sensitivity_plot","text":"","code":"sensitivity_plot(   data,   dims,   result_type,   sub_title = NULL,   title = NULL,   caption = NULL )"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/sensitivity_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sensitivity plot — sensitivity_plot","text":"data data plotted. dims list representing number rows columns plots split . result_type indicator indicates count boxplot plotted. sub_title list titles individual subplot. title title overall figure. caption caption overall figure.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/sensitivity_plot.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Sensitivity plot — sensitivity_plot","text":"function takes output sensitivity() creates grid plots. plot created using ggplot2::geom_count(). number observations location counted count mapped point area plot. x-axis true COI, y-axis estimated COI. counts plotted blue, red line drawn equation \\(y = x\\). line indicates blue circles algorithm 100% correct.","code":""},{"path":[]},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/sensitivity_plot_element.html","id":null,"dir":"Reference","previous_headings":"","what":"Single sensitivity plot — sensitivity_plot_element","title":"Single sensitivity plot — sensitivity_plot_element","text":"Creates single plot sensitivity analysis. Used helper function sensitivity_plot().","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/sensitivity_plot_element.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Single sensitivity plot — sensitivity_plot_element","text":"","code":"sensitivity_plot_element(data, loop_num, result_type, sub_title)"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/sensitivity_plot_element.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Single sensitivity plot — sensitivity_plot_element","text":"data data plotted. loop_num loop number. Represents many total panels plotted. result_type indicator indicates count boxplot plotted. sub_title list titles individual subplot.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/sim_biallelic.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate biallelic data — sim_biallelic","title":"Simulate biallelic data — sim_biallelic","text":"Simulate biallelic data simple statistical model. Inputs include complexity infection (COI), population-level allele frequencies (PLAF), parameters dictating skew error distributions. Outputs include phased haplotypes unphased read count coverage data.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/sim_biallelic.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate biallelic data — sim_biallelic","text":"","code":"sim_biallelic(   coi = 3,   plaf = runif(10, 0, 0.5),   coverage = 200,   alpha = 1,   overdispersion = 0,   relatedness = 0,   epsilon = 0 )"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/sim_biallelic.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate biallelic data — sim_biallelic","text":"coi Complexity infection. plaf Vector population-level allele frequencies locus. coverage Coverage locus. single value coverage applied loci. alpha Shape parameter symmetric Dirichlet prior strain proportions. overdispersion extent counts -dispersed relative binomial distribution. Counts Beta-binomially distributed, beta distribution shape parameters \\(\\frac{p}{overdispersion}\\) \\(\\frac{1-p}{overdispersion}\\). relatedness probability strain mixed infections related another. Default = 0 (unrelated). implementation similar relatedness defined REAL McCOIL simulations. original paper (https://doi.org/10.1371/journal.pcbi.1005348) defined : \"... simulated relatedness (r) among lineages within host sampling alleles either existing lineage within host (probability r) population (probability (1-r)).\" epsilon probability single read miscalled allele. Applies directions.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/sim_biallelic.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate biallelic data — sim_biallelic","text":"list : coi: COI used simulate data. strain_proportions: strain proportion strain. phased: phased haplotype. data: dataframe : plaf: population-level allele frequency. coverage: coverage locus. counts: count locus. wsaf: within-sample allele frequency. inputs: dataframe function input arguments: alpha: Shape parameters Dirichlet controlling strain proportions. overdispersion: Overdispersion count data. relatedness: Within sample relatedness strains. epsilon: Probability single read miscalled.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/sim_biallelic.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Simulate biallelic data — sim_biallelic","text":"Simulated data drawn simple statistical model: Strain proportions drawn symmetric Dirichlet distribution shape parameter alpha. Phased haplotypes drawn every locus, one coi. allele locus drawn Bernoulli distribution probability given plaf. \"true\" within-sample allele frequency every locus obtained multiplying haplotypes strain proportions, summing haplotypes. Errors introduced equation \\[wsaf_{error} = wsaf(1-e) + (1-wsaf)e\\] \\(wsaf\\) WSAF without error \\(e\\) error parameter epsilon. Final read counts drawn beta-binomial distribution expectation \\(w_{error}\\). raw number draws given coverage, skew distribution given overdispersion parameter. overdispersion equal zero, distribution binomial, rather beta-binomial.","code":""},{"path":[]},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/single_sensitivity.html","id":null,"dir":"Reference","previous_headings":"","what":"Single sensitivity analysis — single_sensitivity","title":"Single sensitivity analysis — single_sensitivity","text":"Runs single full COI sensitivity analysis.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/single_sensitivity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Single sensitivity analysis — single_sensitivity","text":"","code":"single_sensitivity(   coi = 3,   max_coi = 25,   plaf = runif(1000, 0, 0.5),   coverage = 200,   alpha = 1,   overdispersion = 0,   relatedness = 0,   epsilon = 0,   seq_error = NULL,   bin_size = 20,   comparison = \"overall\",   distance = \"squared\",   coi_method = \"variant\" )"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/single_sensitivity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Single sensitivity analysis — single_sensitivity","text":"coi Complexity infection. max_coi number indicating maximum COI compare simulated data . plaf Vector population-level allele frequencies locus. coverage Coverage locus. single value coverage applied loci. alpha Shape parameter symmetric Dirichlet prior strain proportions. overdispersion extent counts -dispersed relative binomial distribution. Counts Beta-binomially distributed, beta distribution shape parameters \\(\\frac{p}{overdispersion}\\) \\(\\frac{1-p}{overdispersion}\\). relatedness probability strain mixed infections related another. Default = 0 (unrelated). implementation similar relatedness defined REAL McCOIL simulations. original paper (https://doi.org/10.1371/journal.pcbi.1005348) defined : \"... simulated relatedness (r) among lineages within host sampling alleles either existing lineage within host (probability r) population (probability (1-r)).\" epsilon probability single read miscalled allele. Applies directions. seq_error level sequencing error assumed. value inputted, infer level sequence error. bin_size minimum size bin data. comparison method employed. One \"end\", \"ideal\", \"overall\". distance distance method used determine distance theoretical simulated curves \"overall\" method. One \"abs_sum\", \"sum_abs\", \"squared\". coi_method method use calculate theoretical COI. method either \"variant\" \"frequency\". default value \"variant\".","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/single_sensitivity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Single sensitivity analysis — single_sensitivity","text":"Predicted COI value.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/single_theoretical_coi.html","id":null,"dir":"Reference","previous_headings":"","what":"Single Theoretical COI — single_theoretical_coi","title":"Single Theoretical COI — single_theoretical_coi","text":"Generate theoretical COI curve particular COI value.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/single_theoretical_coi.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Single Theoretical COI — single_theoretical_coi","text":"","code":"single_theoretical_coi(   coi,   plaf = seq(0, 0.5, l = 101),   coi_method = \"variant\" )"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/single_theoretical_coi.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Single Theoretical COI — single_theoretical_coi","text":"coi COI curve calculated. plaf PLAF curve calculated. coi_method method use calculate theoretical COI. method either \"variant\" \"frequency\". default value \"variant\".","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/single_theoretical_coi.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Single Theoretical COI — single_theoretical_coi","text":"theoretical COI curve specified PLAF.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/single_theoretical_coi.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Single Theoretical COI — single_theoretical_coi","text":"theoretical curve can visualized WSAF individual various PLAFs. locus, theoretical COI defined : \\[1-p^{coi}-q^{coi}\\]","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/theme_coiaf.html","id":null,"dir":"Reference","previous_headings":"","what":"Custom ggplot2 theme — theme_coiaf","title":"Custom ggplot2 theme — theme_coiaf","text":"Custom ggplot2 theme","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/theme_coiaf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Custom ggplot2 theme — theme_coiaf","text":"","code":"theme_coiaf(   base_size = 10,   base_family = \"\",   base_line_size = base_size/22,   base_rect_size = base_size/22 )"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/theme_coiaf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Custom ggplot2 theme — theme_coiaf","text":"base_size base font size, given pts. base_family base font family base_line_size base size line elements base_rect_size base size rect elements","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/theme_coiaf.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Custom ggplot2 theme — theme_coiaf","text":"","code":"library(\"ggplot2\") p <- ggplot(mtcars, aes(x = wt, y = mpg, colour = factor(gear))) +   geom_point() +   facet_wrap(~am) +   geom_smooth(method = \"lm\", se = FALSE)  p + theme_coiaf() #> `geom_smooth()` using formula 'y ~ x'"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/theoretical_coi.html","id":null,"dir":"Reference","previous_headings":"","what":"Theoretical COI — theoretical_coi","title":"Theoretical COI — theoretical_coi","text":"Generate theoretical COI curves.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/theoretical_coi.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Theoretical COI — theoretical_coi","text":"","code":"theoretical_coi(coi_range, plaf = seq(0, 0.5, l = 101), coi_method = \"variant\")"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/theoretical_coi.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Theoretical COI — theoretical_coi","text":"coi_range COIs curve calculated. plaf PLAF curve calculated. coi_method method use calculate theoretical COI. method either \"variant\" \"frequency\". default value \"variant\".","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/theoretical_coi.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Theoretical COI — theoretical_coi","text":"theoretical COI curves specified COIs PLAF.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/theoretical_coi.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Theoretical COI — theoretical_coi","text":"theoretical curve can visualized WSAF individual various PLAFs. locus, theoretical COI defined : \\[1-p^{coi}-q^{coi}\\] \\(p\\) PLAF \\(q\\) 1 - PLAF.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/world_map.html","id":null,"dir":"Reference","previous_headings":"","what":"World map plot — world_map","title":"World map plot — world_map","text":"Plot world map showing COI region reads sampled .","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/world_map.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"World map plot — world_map","text":"","code":"world_map(data, variable, label = NULL, alpha = 0.1, breaks = c(1, 2))"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/world_map.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"World map plot — world_map","text":"data data plotted. variable variable data plot. label label variable. alpha alpha value plotted data. breaks breaks color scale.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/world_map.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"World map plot — world_map","text":"Creates world map overlays COI region. magnitude COI indicated color size bubble.","code":""},{"path":[]},{"path":"https://bailey-lab.github.io/coiaf/dev/news/index.html","id":"coiaf-development-version","dir":"Changelog","previous_headings":"","what":"coiaf (development version)","title":"coiaf (development version)","text":"New theme_coiaf() creates custom theme package.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/news/index.html","id":"coiaf-010","dir":"Changelog","previous_headings":"","what":"coiaf 0.1.0","title":"coiaf 0.1.0","text":"Initial public release.","code":""}]
