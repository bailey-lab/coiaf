<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sensitivity Analysis • coiaf</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Sensitivity Analysis">
<meta property="og:description" content="coiaf">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">coiaf</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="..//index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/sensitivity_analysis.html">Sensitivity Αnalysis</a>
    </li>
    <li>
      <a href="../articles/example_real_data.html">Real Data</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/example_coi_prediction.html">COI Prediction</a>
    </li>
    <li>
      <a href="../articles/example_simulation.html">Simulation Example</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ojwatson/coiaf/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="sensitivity_analysis_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Sensitivity Analysis</h1>
                        <h4 class="author">Aris Paschalidis</h4>
            
            <h4 class="date">July 2020</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ojwatson/coiaf/blob/master/vignettes/sensitivity_analysis.Rmd"><code>vignettes/sensitivity_analysis.Rmd</code></a></small>
      <div class="hidden name"><code>sensitivity_analysis.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>In this analysis file, we aim to understand the effect of varying parameters on our COI framework. The parameters that we will examine are:</p>
<ul>
<li>method: The method to be employed. One of <code>"end"</code>, <code>"ideal"</code>, <code>"overall"</code>.</li>
<li>dist_method: The distance method used to determine the distance between the theoretical and simulated curves for the <code>"overall"</code> method. One of <code>"abs_sum"</code>, <code>"sum_abs"</code>, <code>"squared"</code>, <code>"KL"</code>.</li>
<li>weighted: An indicator indicating whether to compute weighted distance.</li>
<li>coverage: Coverage at each locus.</li>
<li>loci: The number of loci.</li>
<li>alpha: Shape parameter of the symmetric Dirichlet prior on strain proportions.</li>
<li>overdispersion: The extent to which counts are over-dispersed relative to the binomial distribution. Counts are Beta-binomially distributed, with the beta distribution having shape parameters <span class="math inline">\(p/\text{overdispersion}\)</span> and <span class="math inline">\((1-p) / \text{overdispersion}\)</span>.</li>
<li>epsilon: The probability of a single read being miscalled as the other allele. Applies in both directions.</li>
<li>seq_error: The level of sequencing error that is assumed.</li>
</ul>
<p>A note of caution, in order to visualize the following tests, <code>ggplot2</code> and <code>ggpubr</code> must be installed.</p>
<div id="default-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#default-parameters" class="anchor"></a>Default Parameters</h2>
<table class="table">
<thead><tr class="header">
<th align="center">Parameter</th>
<th align="center">Default Value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">COI</td>
<td align="center"><code>3</code></td>
</tr>
<tr class="even">
<td align="center">Max COI</td>
<td align="center"><code>25</code></td>
</tr>
<tr class="odd">
<td align="center">PLAF</td>
<td align="center"><code><a href="https://rdrr.io/r/stats/Uniform.html">runif(1000, 0, 0.5)</a></code></td>
</tr>
<tr class="even">
<td align="center">Coverage</td>
<td align="center"><code>100</code></td>
</tr>
<tr class="odd">
<td align="center">Alpha</td>
<td align="center"><code>1</code></td>
</tr>
<tr class="even">
<td align="center">Overdispersion</td>
<td align="center"><code>0</code></td>
</tr>
<tr class="odd">
<td align="center">Epsilon</td>
<td align="center"><code>0</code></td>
</tr>
<tr class="even">
<td align="center">Sequence Error</td>
<td align="center"><code>0.01</code></td>
</tr>
<tr class="odd">
<td align="center">Cut</td>
<td align="center"><code><a href="https://rdrr.io/r/base/seq.html">seq(0, 0.5, 0.01)</a></code></td>
</tr>
<tr class="even">
<td align="center">Method</td>
<td align="center"><code>"overall"</code></td>
</tr>
<tr class="odd">
<td align="center">Distance Method</td>
<td align="center"><code>"squared"</code></td>
</tr>
<tr class="even">
<td align="center">Weighted</td>
<td align="center"><code>TRUE</code></td>
</tr>
</tbody>
</table>
</div>
<div id="setting-our-plaf" class="section level2">
<h2 class="hasAnchor">
<a href="#setting-our-plaf" class="anchor"></a>Setting our PLAF</h2>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="co"># Set the seed</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">1</span>)

<span class="co"># Define number of loci, and distribution of minor allele frequencies</span>
<span class="kw">L</span> <span class="op">&lt;-</span> <span class="fl">1e3</span>
<span class="kw">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">rbeta</a></span>(<span class="kw">L</span>, <span class="fl">1</span>, <span class="fl">5</span>)
<span class="kw">p</span>[<span class="kw">p</span> <span class="op">&gt;</span> <span class="fl">0.5</span>] <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="kw">p</span>[<span class="kw">p</span> <span class="op">&gt;</span> <span class="fl">0.5</span>]
</pre></div>
</div>
</div>
<div id="sensitivity-analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#sensitivity-analysis" class="anchor"></a>Sensitivity Analysis</h1>
<div id="coi" class="section level2">
<h2 class="hasAnchor">
<a href="#coi" class="anchor"></a>COI</h2>
<p>We first want to understand for what range our model can accurately predict the COI.</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="kw">tcoi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/coi_test.html">coi_test</a></span>(COI = <span class="fl">2</span><span class="op">:</span><span class="fl">40</span>, max_COI = <span class="fl">40</span>, repetitions = <span class="fl">100</span>, PLAF = <span class="kw">p</span>)

<span class="kw">tcoi_image</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sensitivity_plot.html">sensitivity_plot</a></span>(data = <span class="kw">tcoi</span>, plot_dims = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">1</span>), title = <span class="st">"COI"</span>)
<span class="kw">tcoi_image</span> 

<span class="kw">tcoi_error</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/error_plot.html">error_plot</a></span>(<span class="kw">tcoi</span>, legend.position = <span class="st">"none"</span>)
<span class="kw">tcoi_error</span>

<span class="co"># N.B. to save the plots, we can use the following code. Write this after the</span>
<span class="co"># call to sensitivity_plot().</span>
<span class="co"># %&gt;% ggpubr::ggexport(filename = "analysis/figures/sensitivity_plots/tcoi_image.png")</span>
<span class="co"># %&gt;% ggpubr::ggexport(filename = "analysis/figures/error_images/tcoi_error.png")</span>
</pre></div>
<p><img src="figures/sensitivity_plots/tcoi_image.png" width="75%"><img src="figures/error_images/tcoi_error.png" width="75%"></p>
<p>Based on the above set of runs, it appears that the algorithm performs well for a very large range of COIs. We see that as the true COI increases, the error and bias likewise increase. However, even at a COI of 40, the error and bias are small, at roughly 4 and -4, respectively. It is interesting to note that our bias is always negative. This indicates that the algorithm consistently underpredicts the COI.</p>
<p>The fact that our model struggles with larger COIs makes sense as at that point, the theoretical COI curves are essentially identical. Although it is remarkable that the algorithm performs this well at COIs that large, COIs of greater than 20 are somewhat unrealistic. For the rest of this document, we only consider COIs of 2 till 20.</p>
</div>
<div id="method" class="section level2">
<h2 class="hasAnchor">
<a href="#method" class="anchor"></a>Method</h2>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="kw">tmethod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/coi_test.html">coi_test</a></span>(COI = <span class="fl">2</span><span class="op">:</span><span class="fl">20</span>, PLAF = <span class="kw">p</span>, method = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"end"</span>, <span class="st">"ideal"</span>, <span class="st">"overall"</span>),
                    dist_method = <span class="st">"squared"</span>, repetitions = <span class="fl">100</span>)

<span class="kw">tmethod_image</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="../reference/sensitivity_plot.html">sensitivity_plot</a></span>(data = <span class="kw">tmethod</span>,
                   plot_dims = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>, <span class="fl">1</span>),
                   change_param = <span class="st">"Method = "</span>,
                   change_param_val = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"End"</span>, <span class="st">"Ideal"</span>, <span class="st">"Overall"</span>))
<span class="kw">tmethod_image</span>

<span class="kw">tmethod_error</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/error_plot.html">error_plot</a></span>(<span class="kw">tmethod</span>, fill = <span class="st">"method"</span>, legend_title = <span class="st">"Method"</span>, 
                            fill_levels = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"End"</span>, <span class="st">"Ideal"</span>, <span class="st">"Overall"</span>),
                            title = <span class="st">"Error Plot for Method"</span>)
<span class="kw">tmethod_error</span>
</pre></div>
<p><img src="figures/sensitivity_plots/tmethod_image.png" width="75%"><img src="figures/error_images/tmethod_error.png" width="75%"></p>
<p>Looking at the images for the three methods: <code>end</code>, <code>ideal</code>, <code>overall</code>, it is clear that the <code>end</code> method does not perform particularly well. For low COI values, more specifically a COI of below 5, the method is accurate. However, with a COI of greater than 5, the algorithm consistently over predicts the COI.</p>
<p>The <code>ideal</code> method, on the other hand performs quite well. For every COI, it will for some runs predict the correct COI. However, the distribution is quite large and the model does not consistently predict the same COI.</p>
<p>The <code>overall</code> method seems to perform the best. It does underpredict the COI for large COI values but the variance in the prediction is less than in the <code>ideal</code> method.</p>
<p>Based on these results, it seem that the <code>ideal</code> method and the <code>overall</code> method are the best. Which one is better is debatable, but for the rest of this document, we will use the <code>overall</code> method.</p>
</div>
<div id="distance-method" class="section level2">
<h2 class="hasAnchor">
<a href="#distance-method" class="anchor"></a>Distance Method</h2>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="kw">tdistance</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/coi_test.html">coi_test</a></span>(COI = <span class="fl">2</span><span class="op">:</span><span class="fl">20</span>, PLAF = <span class="kw">p</span>, method = <span class="st">"overall"</span>,
                      dist_method = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"abs_sum"</span>, <span class="st">"sum_abs"</span>,
                                      <span class="st">"squared"</span>, <span class="st">"KL"</span>),
                      repetitions = <span class="fl">100</span>)

<span class="kw">tdistance_image</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="../reference/sensitivity_plot.html">sensitivity_plot</a></span>(data = <span class="kw">tdistance</span>,
                   plot_dims = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>, <span class="fl">2</span>),
                   change_param = <span class="st">"Distance Method = "</span>,
                   change_param_val = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Absolute Sum"</span>, <span class="st">"Sum of Absolute"</span>,
                                        <span class="st">"Squared Error"</span>, <span class="st">"KL Divergence"</span>))
<span class="kw">tdistance_image</span>

<span class="kw">tdistance_error</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/error_plot.html">error_plot</a></span>(<span class="kw">tdistance</span>, fill = <span class="st">"dist_method"</span>, 
                              legend_title = <span class="st">"Distance Method"</span>, 
                              fill_levels = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Absolute Sum"</span>, <span class="st">"KL Divergence"</span>,
                                              <span class="st">"Squared Error"</span>, <span class="st">"Sum of Absolute"</span>),
                              title = <span class="st">"Error Plot for Distance Method"</span>)
<span class="kw">tdistance_error</span>
</pre></div>
<p><img src="figures/sensitivity_plots/tdistance_image.png" width="75%"><img src="figures/error_images/tdistance_error.png" width="75%"></p>
<p>All of the distance metrics, other than KL divergence, perform quite well for all values of the COI. The KL divergence, although it too performs well, it struggles for low COI values. In some cases the KL method overpredicts and in some cases underpredicts by a large amount. For a COI of 2, for example, the algorithm predicts COIs much higher than the true COI, in some cases even predicting a COI of 12.</p>
</div>
<div id="weighted" class="section level2">
<h2 class="hasAnchor">
<a href="#weighted" class="anchor"></a>Weighted</h2>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="kw">tweight</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/coi_test.html">coi_test</a></span>(COI = <span class="fl">2</span><span class="op">:</span><span class="fl">20</span>, weighted = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">FALSE</span>, <span class="fl">TRUE</span>),
                    dist_method = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"abs_sum"</span>, <span class="st">"sum_abs"</span>,
                                      <span class="st">"squared"</span>, <span class="st">"KL"</span>),
                    PLAF = <span class="kw">p</span>, repetitions = <span class="fl">100</span>)

<span class="kw">tweight_image</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="../reference/sensitivity_plot.html">sensitivity_plot</a></span>(data = <span class="kw">tweight</span>,
                   plot_dims = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>, <span class="fl">4</span>),
                   change_param_val = 
                   <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Abs Sum"</span>, <span class="st">"Sum Abs"</span>, <span class="st">"Squared"</span>, <span class="st">"KL"</span>), <span class="fl">2</span>),
                         <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Not Weighted"</span>, <span class="st">"Weighted"</span>), each = <span class="fl">4</span>)))
<span class="kw">tweight_image</span>

<span class="kw">tweight_error</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/error_plot.html">error_plot</a></span>(<span class="kw">tweight</span>, fill = <span class="st">"dist_method"</span>, 
                            fill_levels = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Absolute Sum"</span>, <span class="st">"KL Divergence"</span>,
                                              <span class="st">"Squared Error"</span>, <span class="st">"Sum of Absolute"</span>),
                            legend_title = <span class="st">"Distance Method"</span>, 
                            title = <span class="st">"Error Plot for Weight"</span>,
                            second_fill = <span class="st">"weighted"</span>)
<span class="kw">tweight_error</span>
</pre></div>
<p><img src="figures/sensitivity_plots/tweight_image.png" width="75%"><img src="figures/error_images/tweight_error.png" width="75%"></p>
<p>Comparing weighted to non-weighted distance metrics, it appears that there is not a large difference between the algorithm’s performance. In general, it appears that by weighing the distance, the algorithm does not underpredict as often, but the difference is very small.</p>
</div>
<div id="coverage" class="section level2">
<h2 class="hasAnchor">
<a href="#coverage" class="anchor"></a>Coverage</h2>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="kw">tcoverage</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/coi_test.html">coi_test</a></span>(COI = <span class="fl">2</span><span class="op">:</span><span class="fl">20</span>, coverage = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">25</span>, <span class="fl">50</span>, <span class="fl">100</span>, <span class="fl">200</span>, <span class="fl">400</span>, <span class="fl">800</span>), 
                 repetitions = <span class="fl">100</span>, PLAF = <span class="kw">p</span>)

<span class="kw">tcoverage_image</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="../reference/sensitivity_plot.html">sensitivity_plot</a></span>(data = <span class="kw">tcoverage</span>,
                   plot_dims = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>, <span class="fl">3</span>),
                   change_param = <span class="st">"Coverage = "</span>,
                   change_param_val = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">25</span>, <span class="fl">50</span>, <span class="fl">100</span>, <span class="fl">200</span>, <span class="fl">400</span>, <span class="fl">800</span>))
<span class="kw">tcoverage_image</span>

<span class="kw">tcoverage_error</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/error_plot.html">error_plot</a></span>(<span class="kw">tcoverage</span>, fill = <span class="st">"coverage"</span>, 
                              legend_title = <span class="st">"Coverage"</span>, 
                              title = <span class="st">"Error Plot for Coverage"</span>)
<span class="kw">tcoverage_error</span>
</pre></div>
<p><img src="figures/sensitivity_plots/tcoverage_image.png" width="75%"><img src="figures/error_images/tcoverage_error.png" width="75%"></p>
<p>It can be seen, based on the figures, that the lower the coverage is, the worse our algorithm does. With a coverage greater than 100, however, there is not a noticeable difference in performance.</p>
</div>
<div id="loci" class="section level2">
<h2 class="hasAnchor">
<a href="#loci" class="anchor"></a>Loci</h2>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="co"># Set the range over which we will iterate</span>
<span class="kw">loci</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1e3</span>, <span class="fl">1e4</span>)

<span class="co"># For each loci, reset the PLAF and then run</span>
<span class="kw">bloci</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="kw">loci</span>, <span class="fu">function</span>(<span class="kw">new_L</span>){
  <span class="kw">new_p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">rbeta</a></span>(<span class="kw">new_L</span>, <span class="fl">1</span>, <span class="fl">5</span>)
  <span class="kw">new_p</span>[<span class="kw">new_p</span> <span class="op">&gt;</span> <span class="fl">0.5</span>] <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="kw">new_p</span>[<span class="kw">new_p</span> <span class="op">&gt;</span> <span class="fl">0.5</span>]
  
  <span class="kw">inner_tloci</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/coi_test.html">coi_test</a></span>(COI = <span class="fl">2</span><span class="op">:</span><span class="fl">20</span>, repetitions = <span class="fl">100</span>, PLAF = <span class="kw">new_p</span>)
  <span class="kw">inner_tloci</span><span class="op">$</span><span class="kw">param_grid</span><span class="op">$</span><span class="kw">loci</span> <span class="op">&lt;-</span> <span class="kw">new_L</span>
  <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="kw">inner_tloci</span>)
})

<span class="co"># Extract the relevant information for each output: predicted_coi, param_grid,</span>
<span class="co"># and boot_error</span>
<span class="kw">pc</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(<span class="kw">cbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="kw">bloci</span>, <span class="fu">function</span>(<span class="kw">test</span>){ <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="kw">test</span><span class="op">$</span><span class="kw">predicted_coi</span>) }))
<span class="kw">pg</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(<span class="kw">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="kw">bloci</span>, <span class="fu">function</span>(<span class="kw">test</span>){ <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="kw">test</span><span class="op">$</span><span class="kw">param_grid</span>) }))
<span class="kw">be</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(<span class="kw">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="kw">bloci</span>, <span class="fu">function</span>(<span class="kw">test</span>){ <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="kw">test</span><span class="op">$</span><span class="kw">boot_error</span>) }))

<span class="co"># Fix the naming for predicted_coi</span>
<span class="kw">num_cois</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="kw">pg</span><span class="op">$</span><span class="kw">COI</span>))
<span class="kw">num_repeat_cois</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">pg</span><span class="op">$</span><span class="kw">COI</span>) <span class="op">/</span> <span class="kw">num_cois</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="kw">pc</span>) <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"coi"</span>, <span class="kw">pg</span><span class="op">$</span><span class="kw">COI</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="kw">num_repeat_cois</span>), each = <span class="kw">num_cois</span>), sep=<span class="st">"_"</span>)

<span class="co"># Create the output</span>
<span class="kw">tloci</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
  predicted_coi = <span class="kw">pc</span>,
  param_grid    = <span class="kw">pg</span>,
  boot_error    = <span class="kw">be</span>
)

<span class="co"># Plot</span>
<span class="kw">tloci_image</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="../reference/sensitivity_plot.html">sensitivity_plot</a></span>(data = <span class="kw">tloci</span>,
                   plot_dims = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>, <span class="fl">1</span>),
                   change_param_val = <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"Loci = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1e3</span>, <span class="fl">1e4</span>)))
<span class="kw">tloci_image</span>

<span class="co"># Add a loci column</span>
<span class="kw">tloci</span><span class="op">$</span><span class="kw">boot_error</span><span class="op">$</span><span class="kw">loci</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1e3</span>, <span class="fl">1e4</span>), 
                             each = <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="kw">tloci</span><span class="op">$</span><span class="kw">boot_error</span><span class="op">$</span><span class="kw">COI</span>)))
<span class="kw">tloci_error</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/error_plot.html">error_plot</a></span>(<span class="kw">tloci</span>, fill = <span class="st">"loci"</span>, 
                          legend_title = <span class="st">"Loci"</span>, 
                          title = <span class="st">"Error Plot for Loci"</span>)
<span class="kw">tloci_error</span>
</pre></div>
<p><img src="figures/sensitivity_plots/tloci_image.png" width="75%"><img src="figures/error_images/tloci_error.png" width="75%"></p>
</div>
<div id="alpha" class="section level2">
<h2 class="hasAnchor">
<a href="#alpha" class="anchor"></a>Alpha</h2>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="kw">talpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/coi_test.html">coi_test</a></span>(COI = <span class="fl">2</span><span class="op">:</span><span class="fl">20</span>, alpha = <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0.01</span>, <span class="fl">5.51</span>, <span class="fl">0.5</span>), 
                 repetitions = <span class="fl">100</span>, PLAF = <span class="kw">p</span>)

<span class="kw">talpha_image</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="../reference/sensitivity_plot.html">sensitivity_plot</a></span>(data = <span class="kw">talpha</span>,
                   plot_dims = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>, <span class="fl">3</span>),
                   change_param = <span class="st">"Alpha = "</span>,
                   change_param_val = <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0.01</span>, <span class="fl">5.51</span>, <span class="fl">0.5</span>)) 
<span class="kw">talpha_image</span>

<span class="kw">talpha_error</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/error_plot.html">error_plot</a></span>(<span class="kw">talpha</span>, fill = <span class="st">"alpha"</span>, 
                           legend_title = <span class="st">"Alpha"</span>, 
                           title = <span class="st">"Error Plot for Alpha"</span>)
<span class="kw">talpha_error</span>
</pre></div>
<p><img src="figures/sensitivity_plots/talpha_image.png" width="75%"><img src="figures/error_images/talpha_error.png" width="75%"></p>
<p>The larger the value of alpha is, the better our model performs. Greater than an alpha of 1.6, however, there is very little difference. When the alpha is low, the model will underpredict the true COI.</p>
</div>
<div id="overdispersion" class="section level2">
<h2 class="hasAnchor">
<a href="#overdispersion" class="anchor"></a>Overdispersion</h2>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="kw">tover</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/coi_test.html">coi_test</a></span>(COI = <span class="fl">2</span><span class="op">:</span><span class="fl">20</span>, overdispersion = <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0</span>, <span class="fl">0.2</span>, <span class="fl">0.05</span>), 
                 repetitions = <span class="fl">100</span>, PLAF = <span class="kw">p</span>)

<span class="kw">tover_image</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="../reference/sensitivity_plot.html">sensitivity_plot</a></span>(data = <span class="kw">tover</span>,
                   plot_dims = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>, <span class="fl">2</span>),
                   change_param = <span class="st">"Overdispersion = "</span>,
                   change_param_val = <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0</span>, <span class="fl">0.2</span>, <span class="fl">0.05</span>))
<span class="kw">tover_image</span>

<span class="kw">tover_error</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/error_plot.html">error_plot</a></span>(<span class="kw">tover</span>, fill = <span class="st">"overdispersion"</span>, 
                          legend_title = <span class="st">"Overdispersion"</span>, 
                          title = <span class="st">"Error Plot for Overdispersion"</span>)
<span class="kw">tover_error</span>
</pre></div>
<p><img src="figures/sensitivity_plots/tover_image.png" width="75%"><img src="figures/error_images/tover_error.png" width="75%"></p>
<p>When you introduce overdispersion, models perform poorly. Any overdispersion causes a large drop in accuracy. This drop in accuracy is caused by the model consistently underpredicting the COI by a large amount.</p>
</div>
<div id="epsilon" class="section level2">
<h2 class="hasAnchor">
<a href="#epsilon" class="anchor"></a>Epsilon</h2>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="kw">tepsilon</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/coi_test.html">coi_test</a></span>(COI = <span class="fl">2</span><span class="op">:</span><span class="fl">20</span>, epsilon = <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0</span>, <span class="fl">0.008</span>, <span class="fl">0.001</span>), 
                 repetitions = <span class="fl">100</span>, PLAF = <span class="kw">p</span>)

<span class="kw">tepsilon_image</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="../reference/sensitivity_plot.html">sensitivity_plot</a></span>(data = <span class="kw">tepsilon</span>,
                   plot_dims = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>, <span class="fl">3</span>),
                   change_param = <span class="st">"Epsilon = "</span>,
                   change_param_val = <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0</span>, <span class="fl">0.008</span>, <span class="fl">0.001</span>))
<span class="kw">tepsilon_image</span>

<span class="kw">tepsilon_error</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/error_plot.html">error_plot</a></span>(<span class="kw">tepsilon</span>, fill = <span class="st">"epsilon"</span>, 
                             legend_title = <span class="st">"Epsilon"</span>, 
                             title = <span class="st">"Error Plot for Epsilon"</span>)
<span class="kw">tepsilon_error</span>
</pre></div>
<p><img src="figures/sensitivity_plots/tepsilon_image.png" width="75%"><img src="figures/error_images/tepsilon_error.png" width="75%"></p>
<p>The algorithm performs best at an epsilon value of 0. As epsilon becomes larger, the model greatly overpredicts the COI. This can be seen for an epsilon of 0.008, where the COI is almost always predicted to be 25, the maximum allowable COI for these tests.</p>
</div>
<div id="sequencing-error" class="section level2">
<h2 class="hasAnchor">
<a href="#sequencing-error" class="anchor"></a>Sequencing Error</h2>
<div class="sourceCode" id="cb11"><pre class="downlit">
<span class="kw">tseq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/coi_test.html">coi_test</a></span>(COI = <span class="fl">2</span><span class="op">:</span><span class="fl">20</span>, epsilon = <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0</span>, <span class="fl">0.008</span>, <span class="fl">0.004</span>), 
                 seq_error = <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0</span>, <span class="fl">0.04</span>, <span class="fl">0.01</span>)[<span class="op">-</span><span class="fl">1</span>], 
                 repetitions = <span class="fl">100</span>, PLAF = <span class="kw">p</span>)

<span class="kw">ep_title</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"Epsilon="</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0</span>, <span class="fl">0.008</span>, <span class="fl">0.004</span>)), <span class="fl">2</span>) 
<span class="kw">seq_title</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"Sequence Error = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0</span>, <span class="fl">0.04</span>, <span class="fl">0.01</span>)[<span class="op">-</span><span class="fl">1</span>]), each = <span class="fl">3</span>)

<span class="kw">tseq_image</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="../reference/sensitivity_plot.html">sensitivity_plot</a></span>(data = <span class="kw">tseq</span>,
                   plot_dims = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>, <span class="fl">3</span>),
                   change_param_val = <span class="kw">seq_title</span>,
                   caption = <span class="fu"><a href="https://rdrr.io/r/base/strwrap.html">strwrap</a></span>(<span class="st">"The first, second, and third columns 
                                     correspond to an epsilon of 0, 0.004, and 
                                     0.008, respectively."</span>nd third columns 
                                     correspond to an epsilon of 0, 0.004, and 
                                     0.008, respectively.", width = <span class="fl">1000</span>))
<span class="kw">tseq_image</span>

<span class="kw">tseq_error</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/error_plot.html">error_plot</a></span>(<span class="kw">tseq</span>, fill = <span class="st">"seq_error"</span>, 
                         legend_title = <span class="st">"Sequence Error"</span>, 
                         title = <span class="st">"Error Plot for Sequence Error"</span>,
                         second_fill = <span class="st">"epsilon"</span>)
<span class="kw">tseq_error</span>
</pre></div>
<p><img src="figures/sensitivity_plots/tseq_image.png" width="75%"><img src="figures/error_images/tseq_error.png" width="75%"></p>
<p>Interestingly, having no sequence error causes problems in the algorithm. Based off the figure, it is clear that introducing some sequence error does combat issues introduced by the value of epsilon. However, if the sequence error is too large, the model starts to underpredict the COI.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Aris Paschalidis, OJ Watson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
