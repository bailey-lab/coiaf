[{"path":"https://bailey-lab.github.io/coiaf/dev/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2022 coiaf authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/articles/example_coi_prediction.html","id":"method-1","dir":"Articles","previous_headings":"","what":"Method 1","title":"Example COI prediction","text":"first approach manuscript document estimating COI shown . works using mean number variant sites, binned groups increasing PLMAF infer COI.  , intercept PLMAF = 0.5 gives us easy way estimate COI, COI = 1 + log_0.5(1-WSMAF), WSMAF = 1 - 0.5^(COI-1). However, differences COI PLMAF = 0.5 become geometrically smaller. Larger gaps can found different COI, smaller PLMAF:","code":"# Loop over range of COIs end_coi <- list() opt_coi <- list() par(mar = c(4, 4, 4, 4)) par(mfrow = c(3, 2)) for (k in 2:7) {    # Simulate data and subset to heterozygous sites only   set.seed(1)   sim1 <- sim_biallelic(coi = k, plmaf = p)    # Plot raw WSMAF as gray dots   plot(sim1$data$plmaf, sim1$data$wsmaf,     pch = 20, cex = 0.5, col = \"gray\", ylim = c(0, 1),     xlab = \"PLMAF\", ylab = \"WSMAF\", main = paste(\"COI =\", k)   )    # Overlay analytical expectations for COI of 2:7   p_vec <- seq(0, 0.5, length.out = 101)   theory_cois <- theoretical_coi(seq(1, 7), p_vec)   for (i in 1:7) {     lines(p_vec, theory_cois[[paste(\"coi_\", i, sep = \"\")]],       col = \"red\", lwd = 2     )   }   text(     x = rep(0.505, 6), y = 1 - 0.5^(1:6), labels = 1:7,     col = \"red\", cex = 0.6   )    # Compute windowed averages over WSMAF and overlay in blue   df_grouped <- process_sim(sim1)    lines(df_grouped$data$midpoints, df_grouped$data$m_variant,     col = \"blue\", lwd = 2, type = \"o\", pch = 20   )    # Predict the COI and print the results   calc_coi <- compute_coi(sim1, \"sim\", max_coi = 50, seq_error = 0.01)   end_coi <- unlist(c(end_coi, calc_coi$coi))    # COI using optimization   add <- optimize_coi(sim1, \"sim\", max_coi = 10)   opt_coi <- unlist(c(opt_coi, add)) } par(mar = c(4, 4, 4, 4)) par(mfrow = c(3, 3)) p_vec <- seq(0, 0.5, length.out = 101) y <- list() for (k in 1:10) {   y[[k]] <- theoretical_coi(k, p_vec)[[1]]    if (k > 1) {     new_y <- y[[k]] - y[[k - 1]]     plot(p_vec, new_y,       ylab = glue::glue(\"Difference between COI {k-1} and {k}\"),       xlab = \"PLMAF\",       main = paste(\"COI = \", k)     )     abline(v = p_vec[which.max(new_y)], lty = 2)     text(       x = p_vec[which.max(new_y)] - 0.02, y = 0.0,       labels = p_vec[which.max(new_y)]     )   } }"},{"path":"https://bailey-lab.github.io/coiaf/dev/articles/example_coi_prediction.html","id":"method-2","dir":"Articles","previous_headings":"","what":"Method 2","title":"Example COI prediction","text":"method 2, plot WSMAF PLMAF sites heterogeneous, .e. REF ALT calls.  case, COI found 1/WSMAF PLMAF = 0 (.e. y-axis intercept).","code":"# loop over range of COIs disc_coi <- list() cont_coi <- list() par(mar = c(4, 4, 4, 4)) par(mfrow = c(3, 2)) for (k in 2:7) {    # simulate data and subset to heterozygous sites only   set.seed(10)   sim1 <- sim_biallelic(coi = k, plmaf = p)    # plot raw WSMAF as grey dots   plot(sim1$data$plmaf, sim1$data$wsmaf,     pch = 20, cex = 0.5, col = \"gray\",     ylim = c(0, 1), xlab = \"PLMAF\", ylab = \"WSMAF\", main = paste(\"COI =\", k)   )    # overlay analytical expectations for COI=2:7   p_vec <- seq(0, 0.5, length.out = 101)   theory_cois <- theoretical_coi(seq(1, 7), p_vec, coi_method = \"frequency\")   for (i in 2:7) {     lines(p_vec, theory_cois[[paste(\"coi_\", i, sep = \"\")]], col = 2, lwd = 2)   }   text(x = rep(-0.005, 6), y = 1 / 2:7, labels = 2:7, col = \"red\", cex = 0.6)    # compute sliding-window averages over WSMAF and overlay in blue   df_grouped <- process_sim(sim1, coi_method = \"frequency\")   print(df_grouped$seq_error)    lines(df_grouped$data$midpoints, df_grouped$data$m_variant,     col = \"blue\", lwd = 2, type = \"o\", pch = 20   )    # Predict the COI and print the results   disc <- compute_coi(sim1, \"sim\", max_coi = 10, coi_method = \"frequency\")   disc_coi <- unlist(c(disc_coi, disc$coi))    # COI using optimization   cont <- optimize_coi(sim1, \"sim\", max_coi = 10, coi_method = \"frequency\")   cont_coi <- unlist(c(cont_coi, cont)) } #> [1] 0.01 #> [1] 0.01 #> [1] 0.01 #> [1] 0.01 #> [1] 0.01 #> [1] 0.01"},{"path":"https://bailey-lab.github.io/coiaf/dev/articles/example_real_data.html","id":"data-structure","dir":"Articles","previous_headings":"","what":"Data structure","title":"Real data example","text":"Data fed algorithm matrix containing WSMAF sample examined locus genome, sample represented rows locus represented columns. first 5 rows 3 columns example real data set included package shown :","code":"print(example_real_data[1:5, 1:3]) #>          Pf3D7_01_v3_94422 Pf3D7_01_v3_95518 Pf3D7_01_v3_100608 #> FP0024-C         0.8205128        0.43548387          0.4972067 #> FP0025-C         1.0000000        0.00000000          1.0000000 #> FP0028-C         0.7389381        0.48000000          1.0000000 #> FP0029-C         1.0000000        1.00000000          1.0000000 #> FP0030-C         0.6250000        0.01882353          1.0000000"},{"path":"https://bailey-lab.github.io/coiaf/dev/articles/example_real_data.html","id":"run-the-algorithm","dir":"Articles","previous_headings":"","what":"Run the algorithm","title":"Real data example","text":"Now data, running algorithm using either two methods quite straightforward. First, must compute PLMAF average WSMAF samples. dataset provided, example_real_data, 10 unique samples 1000 loci . Therefore, find COI sample, must generate loop iterate sample.","code":"plmaf <- colMeans(example_real_data, na.rm = T)"},{"path":[]},{"path":"https://bailey-lab.github.io/coiaf/dev/articles/example_real_data.html","id":"discrete","dir":"Articles","previous_headings":"Run the algorithm > Method 1","what":"Discrete","title":"Real data example","text":"","code":"m1_dis <- lapply(seq_len(nrow(example_real_data)), function(i) {   # We first isolate the WSMAF for that sample and then plug the WSMAF and PLMAF   # into our function   wsmaf <- example_real_data[i, ]   input <- tibble::tibble(wsmaf = wsmaf, plmaf = plmaf) %>% tidyr::drop_na()   res <- compute_coi(input, \"real\", coi_method = \"variant\") })  # compute_coi returns both the COI and a measure of confidence in our prediction # thus we must isolate each separately m1_dis_cois <- lapply(m1_dis, function(x) {   x$coi }) %>% unlist()  # extract the probabilities and assign them names based on what COI was checked m1_dis_probs <- lapply(m1_dis, function(x) {   probs <- x$probability   names(probs) <- paste0(\"COI_\", 1:length(probs))   return(probs) })  # Assign the name of the sample to the returned vectors names(m1_dis_cois) <- rownames(example_real_data) names(m1_dis_probs) <- rownames(example_real_data)"},{"path":"https://bailey-lab.github.io/coiaf/dev/articles/example_real_data.html","id":"continuous","dir":"Articles","previous_headings":"Run the algorithm > Method 1","what":"Continuous","title":"Real data example","text":"","code":"m1_dis_cont <- lapply(seq_len(nrow(example_real_data)), function(i) {   # We first isolate the WSMAF for that sample and then plug the WSMAF and PLMAF   # into our function   wsmaf <- example_real_data[i, ]   input <- tibble::tibble(wsmaf = wsmaf, plmaf = plmaf) %>% tidyr::drop_na()   res <- optimize_coi(input, \"real\", coi_method = \"variant\") }) %>% unlist()  # Assign the name of the sample to the returned vector names(m1_dis_cont) <- rownames(example_real_data)"},{"path":[]},{"path":"https://bailey-lab.github.io/coiaf/dev/articles/example_real_data.html","id":"discrete-1","dir":"Articles","previous_headings":"Run the algorithm > Method 2","what":"Discrete","title":"Real data example","text":"","code":"m2_dis <- lapply(seq_len(nrow(example_real_data)), function(i) {   # We first isolate the WSMAF for that sample and then plug the WSMAF and PLMAF   # into our function   wsmaf <- example_real_data[i, ]   input <- tibble::tibble(wsmaf = wsmaf, plmaf = plmaf) %>% tidyr::drop_na()   res <- compute_coi(input, \"real\", coi_method = \"frequency\") })  # compute_coi returns both the COI and a measure of confidence in our prediction # thus we must isolate each separately m2_dis_cois <- lapply(m2_dis, function(x) {   x$coi }) %>% unlist()  # extract the probabilities and assign them names based on what COI was checked m2_dis_probs <- lapply(m2_dis, function(x) {   probs <- x$probability   names(probs) <- paste0(\"COI_\", 1:length(probs))   return(probs) })  # Assign the name of the sample to the returned vectors names(m2_dis_cois) <- rownames(example_real_data) names(m2_dis_probs) <- rownames(example_real_data)"},{"path":"https://bailey-lab.github.io/coiaf/dev/articles/example_real_data.html","id":"continuous-1","dir":"Articles","previous_headings":"Run the algorithm > Method 2","what":"Continuous","title":"Real data example","text":"","code":"m2_dis_cont <- lapply(seq_len(nrow(example_real_data)), function(i) {   # We first isolate the WSMAF for that sample and then plug the WSMAF and PLMAF   # into our function   wsmaf <- example_real_data[i, ]   input <- tibble::tibble(wsmaf = wsmaf, plmaf = plmaf) %>% tidyr::drop_na()   res <- optimize_coi(input, \"real\", coi_method = \"frequency\") }) %>% unlist()  # Assign the name of the sample to the returned vector names(m2_dis_cont) <- rownames(example_real_data)"},{"path":"https://bailey-lab.github.io/coiaf/dev/articles/example_real_data.html","id":"progress-bar","dir":"Articles","previous_headings":"","what":"Progress bar","title":"Real data example","text":"roughly 1000 loci 10 samples, model take less 0.5 seconds run. may helpful include progress bar running additional loci samples replacing lapply function user defined function. recommend use pbapply package, can used follows: left replace lapply newly defined list_apply.","code":"# Function to determine if pbapply is installed. If it is installed, it will # display a progress bar list_apply <- function(x, fun, ...) {   if (requireNamespace(\"pbapply\", quietly = TRUE)) {     pbapply::pblapply(x, fun, ...)   } else {     lapply(x, fun, ...)   } }"},{"path":"https://bailey-lab.github.io/coiaf/dev/articles/example_real_data.html","id":"data-visualization","dir":"Articles","previous_headings":"","what":"Data visualization","title":"Real data example","text":"recommend exploring ggplot2 package plot results. Graph Gallery beautiful website tons awesome graphs demos may provide inspiration.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/articles/sensitivity_analysis_continuous.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Continuous sensitivity analysis","text":"analysis file, aim understand effect varying parameters COI framework. examine simulation estimation parameters. parameters examine : coverage: Coverage locus. loci: number loci. alpha: Shape parameter symmetric Dirichlet prior strain proportions. overdispersion: extent counts -dispersed relative binomial distribution. Counts Beta-binomially distributed, beta distribution shape parameters \\(p/\\text{overdispersion}\\) \\((1-p) / \\text{overdispersion}\\). relatedness: probability strain mixed infections related another. epsilon: probability single read miscalled allele. Applies directions. coi: complexity infection sample. seq_error: level sequencing error assumed. use_bins: Whether group data estimating COI. bin_size: minimum size bin data.","code":""},{"path":[]},{"path":"https://bailey-lab.github.io/coiaf/dev/articles/sensitivity_analysis_continuous.html","id":"setting-our-plmaf","dir":"Articles","previous_headings":"Introduction","what":"Setting our PLMAF","title":"Continuous sensitivity analysis","text":"","code":"# Set the seed set.seed(1)  # Define number of loci, and distribution of minor allele frequencies L <- 1e3 p <- stats::rbeta(L, 1, 5) p[p > 0.5] <- 1 - p[p > 0.5]"},{"path":"https://bailey-lab.github.io/coiaf/dev/articles/sensitivity_analysis_continuous.html","id":"overall-performance","dir":"Articles","previous_headings":"Introduction","what":"Overall performance","title":"Continuous sensitivity analysis","text":"","code":"toverall <- cont_sensitivity(   coi = 1:20,   repetitions = 100,   plmaf = p,   coverage = 100,   seq_error = 0,   coi_method = c(\"variant\", \"frequency\") )  toverall_image <- sensitivity_plot(   data = toverall,   dims = c(1, 2),   result_type = \"cont\",   title = \"Predicted COI\",   sub_title = c(\"Variant Method\", \"Frequency Method\") )  toverall_error <- error_plot(   data = toverall,   fill = \"coi_method\",   legend_title = \"COI Method\",   title = \"Error\",   fill_levels = c(\"Variant Method\", \"Frequency Method\") )  toverall_fig <- toverall_image / toverall_error +   plot_annotation(     tag_levels = \"A\",     theme = theme(plot.tag = element_text(size = 10))   ) +   theme(legend.position = \"bottom\")  toverall_fig"},{"path":[]},{"path":"https://bailey-lab.github.io/coiaf/dev/articles/sensitivity_analysis_continuous.html","id":"coverage","dir":"Articles","previous_headings":"Simulation parameters","what":"Coverage","title":"Continuous sensitivity analysis","text":"","code":"tcoverage_1 <- cont_sensitivity(   coi = 2:20,   coverage = c(50, 100, 250, 500, 1000, 2000),   repetitions = 100,   seq_error = 0.01,   plmaf = p,   coi_method = \"variant\" )  tcoverage_image_1 <- sensitivity_plot(   data = tcoverage_1,   result_type = \"cont\",   title = \"Predicted COI\",   dims = c(2, 3),   sub_title = paste0(\"Coverage = \", c(50, 100, 250, 500, 1000, 2000)) )  tcoverage_error_1 <- error_plot(   tcoverage_1,   fill = \"coverage\",   legend_title = \"Coverage\",   title = \"Error\" )  tcoverage_fig_1 <- tcoverage_image_1 / tcoverage_error_1 +   plot_annotation(     tag_levels = \"A\",     theme = theme(plot.tag = element_text(size = 10))   ) +   plot_layout(heights = c(2, 1)) +   theme(legend.position = \"bottom\")  tcoverage_fig_1 tcoverage_2 <- cont_sensitivity(   coi = 2:20,   coverage = c(50, 100, 250, 500, 1000, 2000),   repetitions = 100,   seq_error = 0.01,   plmaf = p,   coi_method = \"frequency\" )  tcoverage_image_2 <- sensitivity_plot(   data = tcoverage_2,   result_type = \"cont\",   title = \"Predicted COI\",   dims = c(2, 3),   sub_title = paste0(\"Coverage = \", c(50, 100, 250, 500, 1000, 2000)) )  tcoverage_error_2 <- error_plot(   tcoverage_2,   fill = \"coverage\",   legend_title = \"Coverage\",   title = \"Error\" )  tcoverage_fig_2 <- tcoverage_image_2 / tcoverage_error_2 +   plot_annotation(     tag_levels = \"A\",     theme = theme(plot.tag = element_text(size = 10))   ) +   plot_layout(heights = c(2, 1)) +   theme(legend.position = \"bottom\")  tcoverage_fig_2"},{"path":"https://bailey-lab.github.io/coiaf/dev/articles/sensitivity_analysis_continuous.html","id":"loci","dir":"Articles","previous_headings":"Simulation parameters","what":"Loci","title":"Continuous sensitivity analysis","text":"","code":"# Set the range over which we will iterate loci <- c(1e2, 1e3, 1e4)  # For each loci, reset the PLMAF and then run bloci <- lapply(loci, function(new_L) {   new_p <- rbeta(new_L, 1, 5)   new_p[new_p > 0.5] <- 1 - new_p[new_p > 0.5]    inner_tloci <- cont_sensitivity(     coi = 2:20,     repetitions = 100,     plmaf = new_p,     seq_error = 0.01,     coi_method = \"variant\"   )   inner_tloci$param_grid$loci <- new_L   return(inner_tloci) })  # Extract the relevant information for each output: predicted_coi, probability, # param_grid, and boot_error pc <- do.call(cbind, lapply(bloci, function(test) {   return(test$predicted_coi) })) pb <- do.call(cbind, lapply(bloci, function(test) {   return(test$probability) })) pg <- do.call(rbind, lapply(bloci, function(test) {   return(test$param_grid) })) be <- do.call(rbind, lapply(bloci, function(test) {   return(test$boot_error) }))  # Fix the naming for predicted_coi num_cois <- length(unique(pg$coi)) num_repeat_cois <- length(pg$coi) / num_cois names(pc) <- paste(   \"coi\",   pg$coi,   rep(seq(num_repeat_cois), each = num_cois),   sep = \"_\" )  # Create the output tloci_1 <- list(   predicted_coi = pc,   probability   = pb,   param_grid    = pg,   boot_error    = be )  # Plot tloci_image_1 <- sensitivity_plot(   data = tloci_1,   result_type = \"cont\",   title = \"Predicted COI\",   dims = c(1, 3),   sub_title = paste0(\"Loci = \", c(1e2, 1e3, 1e4)) )  # Add a loci column tloci_1$boot_error$loci <- rep(   c(1e2, 1e3, 1e4),   each = length(unique(tloci_1$boot_error$coi)) ) tloci_error_1 <- error_plot(   tloci_1,   fill = \"loci\",   legend_title = \"Loci\",   title = \"Error\" )  tloci_fig_1 <- tloci_image_1 / tloci_error_1 +   plot_annotation(     tag_levels = \"A\",     theme = theme(plot.tag = element_text(size = 10))   ) +   theme(legend.position = \"bottom\")  tloci_fig_1 # Set the range over which we will iterate loci <- c(1e2, 1e3, 1e4)  # For each loci, reset the PLMAF and then run bloci <- lapply(loci, function(new_L) {   new_p <- rbeta(new_L, 1, 5)   new_p[new_p > 0.5] <- 1 - new_p[new_p > 0.5]    inner_tloci <- cont_sensitivity(     coi = 2:20,     repetitions = 100,     plmaf = new_p,     seq_error = 0.01,     coi_method = \"frequency\"   )   inner_tloci$param_grid$loci <- new_L   return(inner_tloci) })  # Extract the relevant information for each output: predicted_coi, probability, # param_grid, and boot_error pc <- do.call(cbind, lapply(bloci, function(test) {   return(test$predicted_coi) })) pb <- do.call(cbind, lapply(bloci, function(test) {   return(test$probability) })) pg <- do.call(rbind, lapply(bloci, function(test) {   return(test$param_grid) })) be <- do.call(rbind, lapply(bloci, function(test) {   return(test$boot_error) }))  # Fix the naming for predicted_coi num_cois <- length(unique(pg$coi)) num_repeat_cois <- length(pg$coi) / num_cois names(pc) <- paste(   \"coi\",   pg$coi,   rep(seq(num_repeat_cois), each = num_cois),   sep = \"_\" )  # Create the output tloci_2 <- list(   predicted_coi = pc,   probability   = pb,   param_grid    = pg,   boot_error    = be )  # Plot tloci_image_2 <- sensitivity_plot(   data = tloci_2,   result_type = \"cont\",   title = \"Predicted COI\",   dims = c(1, 3),   sub_title = paste0(\"Loci = \", c(1e2, 1e3, 1e4)) )  # Add a loci column tloci_2$boot_error$loci <- rep(   c(1e2, 1e3, 1e4),   each = length(unique(tloci_2$boot_error$coi)) ) tloci_error_2 <- error_plot(   tloci_2,   fill = \"loci\",   legend_title = \"Loci\",   title = \"Error\" )  tloci_fig_2 <- tloci_image_2 / tloci_error_2 +   plot_annotation(     tag_levels = \"A\",     theme = theme(plot.tag = element_text(size = 10))   ) +   theme(legend.position = \"bottom\")  tloci_fig_2"},{"path":"https://bailey-lab.github.io/coiaf/dev/articles/sensitivity_analysis_continuous.html","id":"alpha","dir":"Articles","previous_headings":"Simulation parameters","what":"Alpha","title":"Continuous sensitivity analysis","text":"","code":"talpha_1 <- cont_sensitivity(   coi = 2:20,   alpha = seq(0.01, 5.51, 0.5),   repetitions = 100,   seq_error = 0.01,   plmaf = p )  talpha_image_1 <- sensitivity_plot(   data = talpha_1,   result_type = \"cont\",   title = \"Predicted COI\",   dims = c(4, 3),   sub_title = paste0(\"Alpha = \", seq(0.01, 5.51, 0.5)) )  talpha_error_1 <- error_plot(   talpha_1,   fill = \"alpha\",   legend_title = \"Alpha\",   title = \"Error\" )  talpha_fig_1 <- talpha_image_1 / talpha_error_1 +   plot_annotation(     tag_levels = \"A\",     theme = theme(plot.tag = element_text(size = 10))   ) +   plot_layout(heights = c(5, 1)) +   theme(legend.position = \"bottom\")  talpha_fig_1 talpha_2 <- cont_sensitivity(   coi = 2:20,   alpha = seq(0.01, 5.51, 0.5),   repetitions = 100,   seq_error = 0.01,   plmaf = p )  talpha_image_2 <- sensitivity_plot(   data = talpha_2,   result_type = \"cont\",   title = \"Predicted COI\",   dims = c(4, 3),   sub_title = paste0(\"Alpha = \", seq(0.01, 5.51, 0.5)) )  talpha_error_2 <- error_plot(   talpha_2,   fill = \"alpha\",   legend_title = \"Alpha\",   title = \"Error\" )  talpha_fig_2 <- talpha_image_2 / talpha_error_2 +   plot_annotation(     tag_levels = \"A\",     theme = theme(plot.tag = element_text(size = 10))   ) +   plot_layout(heights = c(5, 1)) +   theme(legend.position = \"bottom\")  talpha_fig_2"},{"path":"https://bailey-lab.github.io/coiaf/dev/articles/sensitivity_analysis_continuous.html","id":"overdispersion","dir":"Articles","previous_headings":"Simulation parameters","what":"Overdispersion","title":"Continuous sensitivity analysis","text":"","code":"tover <- cont_sensitivity(   coi = 2:20,   overdispersion = seq(0, 0.25, 0.05),   repetitions = 100,   seq_error = 0.01,   plmaf = p,   coi_method = c(\"variant\", \"frequency\") )  tover_image <- sensitivity_plot(   data = tover,   result_type = \"cont\",   title = \"Predicted COI\",   dims = c(4, 3),   sub_title = paste0(     rep(c(\"Var, \", \"Freq, \"), each = 6),     \"Dispersion = \",     seq(0, 0.25, 0.05)   ) )  tover_error <- error_plot(   tover,   fill = \"overdispersion\",   legend_title = \"Overdispersion\",   title = \"Error\",   second_fill = \"coi_method\" )  tover_fig <- tover_image / tover_error +   plot_annotation(     tag_levels = \"A\",     theme = theme(plot.tag = element_text(size = 10))   ) +   plot_layout(heights = c(5, 1)) +   theme(legend.position = \"bottom\")  tover_fig"},{"path":"https://bailey-lab.github.io/coiaf/dev/articles/sensitivity_analysis_continuous.html","id":"relatedness","dir":"Articles","previous_headings":"Simulation parameters","what":"Relatedness","title":"Continuous sensitivity analysis","text":"","code":"trelated <- cont_sensitivity(   coi = 2:20,   relatedness = seq(0, 0.5, 0.1),   repetitions = 100,   seq_error = 0.01,   plmaf = p,   coi_method = c(\"variant\", \"frequency\") )  trelated_image <- sensitivity_plot(   data = trelated,   result_type = \"cont\",   title = \"Predicted COI\",   dims = c(4, 3),   sub_title = paste(     paste0(\"Related =  \", seq(0, 0.5, 0.1)),     rep(c(\"Variant Method\", \"Frequency Method\"), each = 6),     sep = \", \"   ) )  trelated_error <- error_plot(   trelated,   fill = \"relatedness\",   legend_title = \"Related\",   title = \"Error\",   second_fill = \"coi_method\" )  trelated_fig <- trelated_image / trelated_error +   plot_annotation(     tag_levels = \"A\",     theme = theme(plot.tag = element_text(size = 10))   ) +   plot_layout(heights = c(6, 1)) +   theme(legend.position = \"bottom\")  trelated_fig"},{"path":"https://bailey-lab.github.io/coiaf/dev/articles/sensitivity_analysis_continuous.html","id":"epsilon","dir":"Articles","previous_headings":"Simulation parameters","what":"Epsilon","title":"Continuous sensitivity analysis","text":"","code":"tepsilon <- cont_sensitivity(   coi = 2:20,   epsilon = seq(0, 0.025, 0.005),   repetitions = 100,   seq_error = 0.01,   plmaf = p )  tepsilon_image <- sensitivity_plot(   data = tepsilon,   result_type = \"cont\",   title = \"Predicted COI\",   sub_title = paste0(\"Epsilon = \", seq(0, 0.025, 0.005)),   dims = c(2, 3) )  tepsilon_error <- error_plot(   tepsilon,   fill = \"epsilon\",   legend_title = \"Epsilon\",   title = \"Error\" )  tepsilon_fig <- tepsilon_image / tepsilon_error +   plot_annotation(     tag_levels = \"A\",     theme = theme(plot.tag = element_text(size = 10))   ) +   plot_layout(heights = c(3, 1)) +   theme(legend.position = \"bottom\")  tepsilon_fig"},{"path":[]},{"path":"https://bailey-lab.github.io/coiaf/dev/articles/sensitivity_analysis_continuous.html","id":"coi","dir":"Articles","previous_headings":"Estimation parameters","what":"COI","title":"Continuous sensitivity analysis","text":"","code":"tcoi <- cont_sensitivity(   coi = 2:40,   max_coi = 40,   repetitions = 100,   plmaf = p,   seq_error = 0.01,   coi_method = c(\"variant\", \"frequency\") )  tcoi_image <- sensitivity_plot(   data = tcoi,   dims = c(1, 2),   result_type = \"cont\",   title = \"Predicted COI\",   sub_title = c(\"Variant Method\", \"Frequency Method\") )  tcoi_error <- error_plot(   tcoi,   fill = \"coi_method\",   legend_title = \"COI Method\",   title = \"Error\",   fill_levels = c(\"Variant Method\", \"Frequency Method\") )  tcoi_fig <- tcoi_image / tcoi_error +   plot_annotation(     tag_levels = \"A\",     theme = theme(plot.tag = element_text(size = 10))   ) +   theme(legend.position = \"bottom\")  tcoi_fig"},{"path":"https://bailey-lab.github.io/coiaf/dev/articles/sensitivity_analysis_continuous.html","id":"sequencing-error","dir":"Articles","previous_headings":"Estimation parameters","what":"Sequencing error","title":"Continuous sensitivity analysis","text":"","code":"tseq <- cont_sensitivity(   coi = 2:20,   epsilon = 0.01,   seq_error = seq(0, 0.10, 0.02),   repetitions = 100,   plmaf = p,   coi_method = c(\"variant\", \"frequency\") )  tseq_image <- sensitivity_plot(   data = tseq,   result_type = \"cont\",   title = \"Predicted COI\",   dims = c(4, 3),   sub_title = paste0(     rep(c(\"Variant, \", \"Frequency, \"), each = 6),     \"Seq Error = \",     seq(0, 0.12, 0.02)   ) )  tseq_error <- error_plot(   tseq,   fill = \"seq_error\",   legend_title = \"Sequence Error\",   title = \"Error\" )  tseq_fig <- tseq_image / tseq_error +   plot_annotation(     tag_levels = \"A\",     theme = theme(plot.tag = element_text(size = 10))   ) +   plot_layout(heights = c(5, 1)) +   theme(legend.position = \"bottom\")  tseq_fig"},{"path":"https://bailey-lab.github.io/coiaf/dev/articles/sensitivity_analysis_continuous.html","id":"bins","dir":"Articles","previous_headings":"Estimation parameters","what":"Bins","title":"Continuous sensitivity analysis","text":"","code":"tbin <- cont_sensitivity(   coi = 2:20,   use_bins = c(TRUE, FALSE),   plmaf = p,   repetitions = 100,   coi_method = c(\"variant\", \"frequency\") )  tbin_image <- sensitivity_plot(   data = tbin,   result_type = \"cont\",   title = \"Predicted COI\",   dims = c(2, 2),   sub_title = paste(     c(\"Variant Method,\", \"Frequency Method,\"),     \"Bins =\",     rep(c(TRUE, FALSE), each = 2)   ) )  tbin_error <- error_plot(   tbin,   fill = \"use_bins\",   fill_levels = as.character(c(TRUE, FALSE)),   legend_title = \"COI Method\",   title = \"Error\",   second_fill = \"coi_method\" )  tbin_fig <- tbin_image / tbin_error +   plot_annotation(     tag_levels = \"A\",     theme = theme(plot.tag = element_text(size = 10))   ) +   plot_layout(heights = c(3, 1)) +   theme(legend.position = \"bottom\")  tbin_fig"},{"path":"https://bailey-lab.github.io/coiaf/dev/articles/sensitivity_analysis_continuous.html","id":"bin-size","dir":"Articles","previous_headings":"Estimation parameters","what":"Bin size","title":"Continuous sensitivity analysis","text":"","code":"tbin_size <- cont_sensitivity(   coi = 2:20,   use_bins = TRUE,   bin_size = seq(10, 100, 30),   plmaf = p,   repetitions = 100,   seq_error = 0.01,   coi_method = c(\"variant\", \"frequency\") )  tbin_size_image <- sensitivity_plot(   data = tbin_size,   result_type = \"cont\",   title = \"Predicted COI\",   dims = c(2, 4),   sub_title = rep(paste(\"Bin Size =\", seq(10, 100, 30)), 2) )  tbin_size_error <- error_plot(   tbin_size,   fill = \"bin_size\",   fill_levels = as.character(seq(10, 100, 30)),   legend_title = \"COI Method\",   title = \"Error\" )  tbin_size_fig <- tbin_size_image / tbin_size_error +   plot_annotation(     tag_levels = \"A\",     theme = theme(plot.tag = element_text(size = 10))   ) +   plot_layout(heights = c(3, 1)) +   theme(legend.position = \"bottom\")  tbin_size_fig"},{"path":"https://bailey-lab.github.io/coiaf/dev/articles/sensitivity_analysis_discrete.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Discrete sensitivity analysis","text":"analysis file, aim understand effect varying parameters COI framework. examine simulation estimation parameters. parameters examine : coverage: Coverage locus. loci: number loci. alpha: Shape parameter symmetric Dirichlet prior strain proportions. overdispersion: extent counts -dispersed relative binomial distribution. Counts Beta-binomially distributed, beta distribution shape parameters \\(p/\\text{overdispersion}\\) \\((1-p) / \\text{overdispersion}\\). relatedness: probability strain mixed infections related another. epsilon: probability single read miscalled allele. Applies directions. coi: complexity infection sample. seq_error: level sequencing error assumed. use_bins: Whether group data estimating COI. bin_size: minimum size bin data.","code":""},{"path":[]},{"path":"https://bailey-lab.github.io/coiaf/dev/articles/sensitivity_analysis_discrete.html","id":"setting-our-plmaf","dir":"Articles","previous_headings":"Introduction","what":"Setting our PLMAF","title":"Discrete sensitivity analysis","text":"","code":"# Set the seed set.seed(1)  # Define number of loci, and distribution of minor allele frequencies L <- 1e3 p <- stats::rbeta(L, 1, 5) p[p > 0.5] <- 1 - p[p > 0.5]"},{"path":"https://bailey-lab.github.io/coiaf/dev/articles/sensitivity_analysis_discrete.html","id":"overall-performance","dir":"Articles","previous_headings":"Introduction","what":"Overall performance","title":"Discrete sensitivity analysis","text":"","code":"toverall <- disc_sensitivity(   coi = 1:20,   repetitions = 100,   plmaf = p,   coverage = 100,   seq_error = 0,   coi_method = c(\"variant\", \"frequency\") )  toverall_image <- sensitivity_plot(   data = toverall,   dims = c(1, 2),   result_type = \"disc\",   title = \"Predicted COI\",   sub_title = c(\"Variant Method\", \"Frequency Method\") )  toverall_error <- error_plot(   data = toverall,   fill = \"coi_method\",   legend_title = \"COI Method\",   title = \"Error\",   fill_levels = c(\"Variant Method\", \"Frequency Method\") )  toverall_fig <- toverall_image / toverall_error +   plot_annotation(     tag_levels = \"A\",     theme = theme(plot.tag = element_text(size = 10))   ) +   theme(legend.position = \"bottom\")  toverall_fig"},{"path":[]},{"path":"https://bailey-lab.github.io/coiaf/dev/articles/sensitivity_analysis_discrete.html","id":"coverage","dir":"Articles","previous_headings":"Simulation parameters","what":"Coverage","title":"Discrete sensitivity analysis","text":"","code":"tcoverage_1 <- disc_sensitivity(   coi = 2:20,   coverage = c(50, 100, 250, 500, 1000, 2000),   repetitions = 100,   seq_error = 0.01,   plmaf = p,   coi_method = \"variant\" )  tcoverage_image_1 <- sensitivity_plot(   data = tcoverage_1,   result_type = \"disc\",   title = \"Predicted COI\",   dims = c(2, 3),   sub_title = paste0(\"Coverage = \", c(50, 100, 250, 500, 1000, 2000)) )  tcoverage_error_1 <- error_plot(   tcoverage_1,   fill = \"coverage\",   legend_title = \"Coverage\",   title = \"Error\" )  tcoverage_fig_1 <- tcoverage_image_1 / tcoverage_error_1 +   plot_annotation(     tag_levels = \"A\",     theme = theme(plot.tag = element_text(size = 10))   ) +   plot_layout(heights = c(2, 1)) +   theme(legend.position = \"bottom\")  tcoverage_fig_1 tcoverage_2 <- disc_sensitivity(   coi = 2:20,   coverage = c(50, 100, 250, 500, 1000, 2000),   repetitions = 100,   seq_error = 0.01,   plmaf = p, coi_method = \"frequency\" )  tcoverage_image_2 <- sensitivity_plot(   data = tcoverage_2,   result_type = \"disc\",   title = \"Predicted COI\",   dims = c(2, 3),   sub_title = paste0(\"Coverage = \", c(50, 100, 250, 500, 1000, 2000)) )  tcoverage_error_2 <- error_plot(   tcoverage_2,   fill = \"coverage\",   legend_title = \"Coverage\",   title = \"Error\" )  tcoverage_fig_2 <- tcoverage_image_2 / tcoverage_error_2 +   plot_annotation(     tag_levels = \"A\",     theme = theme(plot.tag = element_text(size = 10))   ) +   plot_layout(heights = c(2, 1)) +   theme(legend.position = \"bottom\")  tcoverage_fig_2"},{"path":"https://bailey-lab.github.io/coiaf/dev/articles/sensitivity_analysis_discrete.html","id":"loci","dir":"Articles","previous_headings":"Simulation parameters","what":"Loci","title":"Discrete sensitivity analysis","text":"","code":"# Set the range over which we will iterate loci <- c(1e2, 1e3, 1e4)  # For each loci, reset the PLMAF and then run bloci <- lapply(loci, function(new_L) {   new_p <- rbeta(new_L, 1, 5)   new_p[new_p > 0.5] <- 1 - new_p[new_p > 0.5]    inner_tloci <- disc_sensitivity(     coi = 2:20,     repetitions = 100,     plmaf = new_p,     seq_error = 0.01,     coi_method = \"variant\"   )   inner_tloci$param_grid$loci <- new_L   return(inner_tloci) })  # Extract the relevant information for each output: predicted_coi, probability, # param_grid, and boot_error pc <- do.call(cbind, lapply(bloci, function(test) {   return(test$predicted_coi) })) pb <- do.call(cbind, lapply(bloci, function(test) {   return(test$probability) })) pg <- do.call(rbind, lapply(bloci, function(test) {   return(test$param_grid) })) be <- do.call(rbind, lapply(bloci, function(test) {   return(test$boot_error) }))  # Fix the naming for predicted_coi num_cois <- length(unique(pg$coi)) num_repeat_cois <- length(pg$coi) / num_cois names(pc) <- paste(   \"coi\",   pg$coi,   rep(seq(num_repeat_cois), each = num_cois),   sep = \"_\" )  # Create the output tloci_1 <- list(   predicted_coi = pc,   probability   = pb,   param_grid    = pg,   boot_error    = be )  # Plot tloci_image_1 <- sensitivity_plot(   data = tloci_1,   result_type = \"disc\",   title = \"Predicted COI\",   dims = c(1, 3),   sub_title = paste0(\"Loci = \", c(1e2, 1e3, 1e4)) )  # Add a loci column tloci_1$boot_error$loci <- rep(   c(1e2, 1e3, 1e4),   each = length(unique(tloci_1$boot_error$coi)) ) tloci_error_1 <- error_plot(   tloci_1,   fill = \"loci\",   legend_title = \"Loci\",   title = \"Error\" )  tloci_fig_1 <- tloci_image_1 / tloci_error_1 +   plot_annotation(     tag_levels = \"A\",     theme = theme(plot.tag = element_text(size = 10))   ) +   theme(legend.position = \"bottom\")  tloci_fig_1 # Set the range over which we will iterate loci <- c(1e2, 1e3, 1e4)  # For each loci, reset the PLMAF and then run bloci <- lapply(loci, function(new_L) {   new_p <- rbeta(new_L, 1, 5)   new_p[new_p > 0.5] <- 1 - new_p[new_p > 0.5]    inner_tloci <- disc_sensitivity(     coi = 2:20,     repetitions = 100,     plmaf = new_p,     seq_error = 0.01,     coi_method = \"frequency\"   )   inner_tloci$param_grid$loci <- new_L   return(inner_tloci) })  # Extract the relevant information for each output: predicted_coi, probability, # param_grid, and boot_error pc <- do.call(cbind, lapply(bloci, function(test) {   return(test$predicted_coi) })) pb <- do.call(cbind, lapply(bloci, function(test) {   return(test$probability) })) pg <- do.call(rbind, lapply(bloci, function(test) {   return(test$param_grid) })) be <- do.call(rbind, lapply(bloci, function(test) {   return(test$boot_error) }))  # Fix the naming for predicted_coi num_cois <- length(unique(pg$coi)) num_repeat_cois <- length(pg$coi) / num_cois names(pc) <- paste(   \"coi\",   pg$coi,   rep(seq(num_repeat_cois), each = num_cois),   sep = \"_\" )  # Create the output tloci_2 <- list(   predicted_coi = pc,   probability   = pb,   param_grid    = pg,   boot_error    = be )  # Plot tloci_image_2 <- sensitivity_plot(   data = tloci_2,   result_type = \"disc\",   title = \"Predicted COI\",   dims = c(1, 3),   sub_title = paste0(\"Loci = \", c(1e2, 1e3, 1e4)) )  # Add a loci column tloci_2$boot_error$loci <- rep(   c(1e2, 1e3, 1e4),   each = length(unique(tloci_2$boot_error$coi)) ) tloci_error_2 <- error_plot(   tloci_2,   fill = \"loci\",   legend_title = \"Loci\",   title = \"Error\" )  tloci_fig_2 <- tloci_image_2 / tloci_error_2 +   plot_annotation(     tag_levels = \"A\",     theme = theme(plot.tag = element_text(size = 10))   ) +   theme(legend.position = \"bottom\")  tloci_fig_2"},{"path":"https://bailey-lab.github.io/coiaf/dev/articles/sensitivity_analysis_discrete.html","id":"alpha","dir":"Articles","previous_headings":"Simulation parameters","what":"Alpha","title":"Discrete sensitivity analysis","text":"","code":"talpha_1 <- disc_sensitivity(   coi = 2:20,   alpha = seq(0.01, 5.51, 0.5),   repetitions = 100,   seq_error = 0.01,   plmaf = p,   coi_method = \"variant\" )  talpha_image_1 <- sensitivity_plot(   data = talpha_1,   result_type = \"disc\",   title = \"Predicted COI\",   dims = c(4, 3),   sub_title = paste0(\"Alpha = \", seq(0.01, 5.51, 0.5)) )  talpha_error_1 <- error_plot(   talpha_1,   fill = \"alpha\",   legend_title = \"Alpha\",   title = \"Error\" )  talpha_fig_1 <- talpha_image_1 / talpha_error_1 +   plot_annotation(     tag_levels = \"A\",     theme = theme(plot.tag = element_text(size = 10))   ) +   plot_layout(heights = c(5, 1)) +   theme(legend.position = \"bottom\")  talpha_fig_1 talpha_2 <- disc_sensitivity(   coi = 2:20,   alpha = seq(0.01, 5.51, 0.5),   repetitions = 100,   seq_error = 0.01,   plmaf = p,   coi_method = \"frequency\" )  talpha_image_2 <- sensitivity_plot(   data = talpha_2,   result_type = \"disc\",   title = \"Predicted COI\",   dims = c(4, 3),   sub_title = paste0(\"Alpha = \", seq(0.01, 5.51, 0.5)) )  talpha_error_2 <- error_plot(   talpha_2,   fill = \"alpha\",   legend_title = \"Alpha\",   title = \"Error\" )  talpha_fig_2 <- talpha_image_2 / talpha_error_2 +   plot_annotation(     tag_levels = \"A\",     theme = theme(plot.tag = element_text(size = 10))   ) +   plot_layout(heights = c(5, 1)) +   theme(legend.position = \"bottom\")  talpha_fig_2"},{"path":"https://bailey-lab.github.io/coiaf/dev/articles/sensitivity_analysis_discrete.html","id":"overdispersion","dir":"Articles","previous_headings":"Simulation parameters","what":"Overdispersion","title":"Discrete sensitivity analysis","text":"","code":"tover <- disc_sensitivity(   coi = 2:20,   overdispersion = seq(0, 0.25, 0.05),   repetitions = 100,   seq_error = 0.01,   plmaf = p,   coi_method = c(\"variant\", \"frequency\") )  tover_image <- sensitivity_plot(   data = tover,   result_type = \"disc\",   title = \"Predicted COI\",   dims = c(4, 3),   sub_title = paste0(     rep(c(\"Var, \", \"Freq, \"), each = 6),     \"Dispersion = \",     seq(0, 0.25, 0.05)   ) )  tover_error <- error_plot(   tover,   fill = \"overdispersion\",   legend_title = \"Overdispersion\",   title = \"Error\",   second_fill = \"coi_method\" )  tover_fig <- tover_image / tover_error +   plot_annotation(     tag_levels = \"A\",     theme = theme(plot.tag = element_text(size = 10))   ) +   plot_layout(heights = c(5, 1)) +   theme(legend.position = \"bottom\")  tover_fig"},{"path":"https://bailey-lab.github.io/coiaf/dev/articles/sensitivity_analysis_discrete.html","id":"relatedness","dir":"Articles","previous_headings":"Simulation parameters","what":"Relatedness","title":"Discrete sensitivity analysis","text":"","code":"trelated <- disc_sensitivity(   coi = 2:20,   relatedness = seq(0, 0.5, 0.1),   repetitions = 100,   seq_error = 0.01,   plmaf = p,   coi_method = c(\"variant\", \"frequency\") )  trelated_image <- sensitivity_plot(   data = trelated,   result_type = \"disc\",   title = \"Predicted COI\",   dims = c(4, 3),   sub_title = paste(     paste0(\"Relatedness =  \", seq(0, 0.5, 0.1)),     rep(c(\"Variant\", \"Frequency\"), each = 6),     sep = \", \"   ) )  trelated_error <- error_plot(   trelated,   fill = \"relatedness\",   legend_title = \"Related\",   title = \"Error\",   second_fill = \"coi_method\" )  trelated_fig <- trelated_image / trelated_error +   plot_annotation(     tag_levels = \"A\",     theme = theme(plot.tag = element_text(size = 10))   ) +   plot_layout(heights = c(6, 1)) +   theme(legend.position = \"bottom\")  trelated_fig"},{"path":"https://bailey-lab.github.io/coiaf/dev/articles/sensitivity_analysis_discrete.html","id":"epsilon","dir":"Articles","previous_headings":"Simulation parameters","what":"Epsilon","title":"Discrete sensitivity analysis","text":"","code":"tepsilon <- disc_sensitivity(   coi = 2:20,   epsilon = seq(0, 0.02, 0.005),   repetitions = 100,   seq_error = 0.01,   plmaf = p,   coi_method = c(\"variant\", \"frequency\") )  tepsilon_image <- sensitivity_plot(   data = tepsilon,   result_type = \"disc\",   title = \"Predicted COI\",   dims = c(4, 3),   sub_title = paste0(     rep(c(\"Variant, \", \"Frequency, \"), each = 5),     \"Epsilon = \",     seq(0, 0.02, 0.005)   ) )  tepsilon_error <- error_plot(   tepsilon,   fill = \"epsilon\",   legend_title = \"Epsilon\",   title = \"Error\",   second_fill = \"coi_method\" )  tepsilon_fig <- tepsilon_image / tepsilon_error +   plot_annotation(     tag_levels = \"A\",     theme = theme(plot.tag = element_text(size = 10))   ) +   plot_layout(heights = c(3, 1)) +   theme(legend.position = \"bottom\")  tepsilon_fig"},{"path":[]},{"path":"https://bailey-lab.github.io/coiaf/dev/articles/sensitivity_analysis_discrete.html","id":"coi","dir":"Articles","previous_headings":"Estimation parameters","what":"COI","title":"Discrete sensitivity analysis","text":"","code":"tcoi <- disc_sensitivity(   coi = 2:40,   max_coi = 40,   repetitions = 100,   plmaf = p,   seq_error = 0.01,   coi_method = c(\"variant\", \"frequency\") )  tcoi_image <- sensitivity_plot(   data = tcoi,   dims = c(1, 2),   result_type = \"disc\",   title = \"Predicted COI\",   sub_title = c(\"Variant Method\", \"Frequency Method\") )  tcoi_error <- error_plot(   tcoi,   fill = \"coi_method\",   legend_title = \"COI Method\",   title = \"Error\",   fill_levels = c(\"Variant Method\", \"Frequency Method\") )  tcoi_fig <- tcoi_image / tcoi_error +   plot_annotation(     tag_levels = \"A\",     theme = theme(plot.tag = element_text(size = 10))   ) +   theme(legend.position = \"bottom\")  tcoi_fig"},{"path":"https://bailey-lab.github.io/coiaf/dev/articles/sensitivity_analysis_discrete.html","id":"sequencing-error","dir":"Articles","previous_headings":"Estimation parameters","what":"Sequencing error","title":"Discrete sensitivity analysis","text":"","code":"tseq <- disc_sensitivity(   coi = 2:20,   epsilon = 0.01,   seq_error = seq(0, 0.10, 0.02),   repetitions = 100,   plmaf = p,   coi_method = c(\"variant\", \"frequency\") )  tseq_image <- sensitivity_plot(   data = tseq,   result_type = \"disc\",   title = \"Predicted COI\",   dims = c(4, 3),   sub_title = paste0(     rep(c(\"Variant, \", \"Frequency, \"), each = 6),     \"Seq Error = \",     seq(0, 0.12, 0.02)   ) )  tseq_error <- error_plot(   tseq,   fill = \"seq_error\",   legend_title = \"Sequence Error\",   title = \"Error\",   second_fill = \"coi_method\" )  tseq_fig <- tseq_image / tseq_error +   plot_annotation(     tag_levels = \"A\",     theme = theme(plot.tag = element_text(size = 10))   ) +   plot_layout(heights = c(5, 1)) +   theme(legend.position = \"bottom\")  tseq_fig"},{"path":"https://bailey-lab.github.io/coiaf/dev/articles/sensitivity_analysis_discrete.html","id":"bins","dir":"Articles","previous_headings":"Estimation parameters","what":"Bins","title":"Discrete sensitivity analysis","text":"","code":"tbin <- disc_sensitivity(   coi = 2:20,   use_bins = c(TRUE, FALSE),   plmaf = p,   repetitions = 100,   coi_method = c(\"variant\", \"frequency\") )  tbin_image <- sensitivity_plot(   data = tbin,   result_type = \"disc\",   title = \"Predicted COI\",   dims = c(2, 2),   sub_title = paste(     c(\"Variant Method,\", \"Frequency Method,\"),     \"Bins =\",     rep(c(TRUE, FALSE), each = 2)   ) )  tbin_error <- error_plot(   tbin,   fill = \"use_bins\",   fill_levels = as.character(c(TRUE, FALSE)),   legend_title = \"COI Method\",   title = \"Error\",   second_fill = \"coi_method\" )  tbin_fig <- tbin_image / tbin_error +   plot_annotation(     tag_levels = \"A\",     theme = theme(plot.tag = element_text(size = 10))   ) +   plot_layout(heights = c(3, 1)) +   theme(legend.position = \"bottom\")  tbin_fig"},{"path":"https://bailey-lab.github.io/coiaf/dev/articles/sensitivity_analysis_discrete.html","id":"bin-size","dir":"Articles","previous_headings":"Estimation parameters","what":"Bin size","title":"Discrete sensitivity analysis","text":"","code":"tbin_size <- disc_sensitivity(   coi = 2:20,   use_bins = TRUE,   bin_size = seq(10, 100, 30),   plmaf = p,   repetitions = 100,   seq_error = 0.01,   coi_method = c(\"variant\", \"frequency\") )  tbin_size_image <- sensitivity_plot(   data = tbin_size,   result_type = \"disc\",   title = \"Predicted COI\",   dims = c(2, 4),   sub_title = rep(paste(\"Bin Size =\", seq(10, 100, 30)), 2) )  tbin_size_error <- error_plot(   tbin_size,   fill = \"bin_size\",   fill_levels = as.character(seq(10, 100, 30)),   legend_title = \"COI Method\",   title = \"Error\" )  tbin_size_fig <- tbin_size_image / tbin_size_error +   plot_annotation(     tag_levels = \"A\",     theme = theme(plot.tag = element_text(size = 10))   ) +   plot_layout(heights = c(3, 1)) +   theme(legend.position = \"bottom\")  tbin_size_fig"},{"path":"https://bailey-lab.github.io/coiaf/dev/articles/simulator_details.html","id":"example-simulation","dir":"Articles","previous_headings":"","what":"Example simulation","title":"Simulator details","text":"package defines function sim_biallelic() can easily used simulate data given sample. use , user may simply specify COI simulated sample population level minor allele frequency (PLMAF). outputs function include phased haplotypes within sample minor allele frequencies (WSMAF) locus.  Internally, function goes several steps generate final output. first step generating simulated data generate population level minor allele frequency (PLMAF). , sample Beta distribution. cases COI greater 1, multiple strains differing proportions sample. order determine proportion strain present sample, sample Dirichlet distribution. order determine within sample minor allele frequency (WSMAF) locus, must determine phased haplotype strain. , draw Binomial distribution probabilities given PLMAF. determine true WSMAF, can simply combine haplotype information strain proportions—finding sum strain proportions strains minor allele particular locus. Lastly, generate final simulated WSMAF account sequencing error, sample number sequence reads minor allele locus, determine WSMAF dividing number reads minor allele coverage locus.","code":"simulation <- sim_biallelic(2, plmaf = runif(1000, 0, 0.5)) plot(simulation) # Set the seed set.seed(1)  # Define number of loci and the PLMAF n_loci <- 5 plmaf <- rbeta(n_loci, 1, 5) plmaf[plmaf > 0.5] <- 1 - plmaf[plmaf > 0.5] strain_p <- coiaf:::rdirichlet(rep(alpha, COI)) haplotype <- mapply(function(x) rbinom(COI, 1, x), x = plmaf) true_wsmaf <- colSums(sweep(haplotype, 1, strain_p, \"*\"))  # Rounding errors can cause numbers greater than 1 true_wsmaf[true_wsmaf > 1] <- 1L # Account for sequencing error true_wsmaf <- true_wsmaf * (1 - epsilon) + (1 - true_wsmaf) * epsilon  # Sample sequence reads counts <- rbinom(n_loci, size = rep(coverage, n_loci), prob = true_wsmaf)  # Determine simulated WSMAF sim_wsmaf <- counts / coverage"},{"path":"https://bailey-lab.github.io/coiaf/dev/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Aris Paschalidis. Author, maintainer. OJ Watson. Author.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Paschalidis , Watson O (2022). coiaf: Complexity Infection Estimation Allele Frequencies. https://bailey-lab.github.io/coiaf/, https://github.com/bailey-lab/coiaf.","code":"@Manual{,   title = {coiaf: Complexity of Infection Estimation with Allele Frequencies},   author = {Aris Paschalidis and OJ Watson},   year = {2022},   note = {https://bailey-lab.github.io/coiaf/, https://github.com/bailey-lab/coiaf}, }"},{"path":[]},{"path":"https://bailey-lab.github.io/coiaf/dev/index.html","id":"introduction","dir":"","previous_headings":"","what":"Introduction","title":"Complexity of Infection Estimation with Allele Frequencies","text":"malaria, individuals often infected different parasite strains, complexity infection (COI) giving number genetically different parasite strains individual. Changes mean COI population shown informative changes transmission intensity number probabilistic likelihood Bayesian models now developed estimate COI. However, rapid, direct measures based heterozygosity FwS directly related COI. package present two new methods use easily calculated measures directly estimate COI sequence read depth data.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Complexity of Infection Estimation with Allele Frequencies","text":"","code":"# Install development version devtools::install_github(\"bailey-lab/coiaf\")"},{"path":"https://bailey-lab.github.io/coiaf/dev/index.html","id":"usage","dir":"","previous_headings":"","what":"Usage","title":"Complexity of Infection Estimation with Allele Frequencies","text":"Please consult example real data vignette primer run real data using coiaf. description estimation methods work, please consult example coi prediction vignette.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/index.html","id":"development","dir":"","previous_headings":"Usage","what":"Development","title":"Complexity of Infection Estimation with Allele Frequencies","text":"Please note package still development may missing features.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/coiaf-package.html","id":null,"dir":"Reference","previous_headings":"","what":"coiaf: Complexity of Infection Estimation with Allele Frequencies — coiaf-package","title":"coiaf: Complexity of Infection Estimation with Allele Frequencies — coiaf-package","text":"Provides direct method estimating complexity infection using easily calculated measures sequence read depth data.","code":""},{"path":[]},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/coiaf-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"coiaf: Complexity of Infection Estimation with Allele Frequencies — coiaf-package","text":"Maintainer: Aris Paschalidis aris_paschalidis@brown.edu (ORCID) Authors: OJ Watson oj.watson@hotmail.co.uk (ORCID)","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/compute_coi.html","id":null,"dir":"Reference","previous_headings":"","what":"Predict the COI — compute_coi","title":"Predict the COI — compute_coi","text":"Predict COI sample.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/compute_coi.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predict the COI — compute_coi","text":"","code":"compute_coi(   data,   data_type,   max_coi = 25,   seq_error = 0.01,   bin_size = 20,   comparison = \"overall\",   distance = \"squared\",   coi_method = \"variant\",   use_bins = FALSE )"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/compute_coi.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predict the COI — compute_coi","text":"data data COI computed. data_type type data analyzed. One \"sim\" \"real\". max_coi number indicating maximum COI compare simulated data . seq_error level sequencing error assumed. value inputted, infer level sequence error. bin_size minimum size bin data. comparison method employed. One \"end\", \"ideal\", \"overall\". distance distance method used determine distance theoretical simulated curves \"overall\" method. One \"abs_sum\", \"sum_abs\", \"squared\". coi_method method use calculate theoretical COI. method either \"variant\" \"frequency\". default value \"variant\". use_bins calculate COI comparing data grouped bins changing plaf . Default = FALSE.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/compute_coi.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Predict the COI — compute_coi","text":"list following: coi: predicted COI sample. probability: probability density function representing probability COI.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/compute_coi.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Predict the COI — compute_coi","text":"Compare within sample allele frequency (WSMAF) population level allele frequency (PLMAF) sample theoretical WSMAF PLMAF look like. examining sample's WSMAF PLMAF theoretical WSMAF PLMAF, estimation can made COI sample . refer sample's WSMAF vs PLMAF \"sample curve\" refer theoretical WSMAF vs PLMAF \"theoretical curve.\" determine predicted COI value, one three different methods can selected: end Determines distance theoretical sample curve PLMAF 0.5. COI whichever theoretical COI curve smallest distance simulated data. ideal Determines distance theoretical sample curve ideal PLMAF. ideal PLMAF calculated looking change COI \\(\\) COI \\(-1\\) finding PLMAF distance maximized. COI whichever theoretical COI curve smallest distance simulated data ideal PLMAF. overall Determines distance theoretical simulated curve PLMAFs. Computes distance theoretical curves simulated curve. COI whichever theoretical curve smallest distance simulated curve. option choose one several distance metrics: abs_sum: Absolute value sum difference. sum_abs: Sum absolute difference. squared: Sum squared difference.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/compute_coi_regression.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute COI based on residauals of all loci against theoretical curves — compute_coi_regression","title":"Compute COI based on residauals of all loci against theoretical curves — compute_coi_regression","text":"Compute COI based residauals loci theoretical curves","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/compute_coi_regression.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute COI based on residauals of all loci against theoretical curves — compute_coi_regression","text":"","code":"compute_coi_regression(   data,   data_type,   max_coi = 25,   seq_error = 0.01,   distance = \"squared\",   coi_method = \"variant\",   seq_error_bin_size = 20 )"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/compute_coi_regression.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute COI based on residauals of all loci against theoretical curves — compute_coi_regression","text":"data data COI computed. data_type type data analyzed. One \"sim\" \"real\". max_coi number indicating maximum COI compare simulated data . seq_error level sequencing error assumed. value inputted, infer level sequence error. distance distance method used determine distance theoretical simulated curves \"overall\" method. One \"abs_sum\", \"sum_abs\", \"squared\". coi_method method use calculate theoretical COI. method either \"variant\" \"frequency\". default value \"variant\". seq_error_bin_size Number loci smallest bin estimating sequence error","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/compute_coi_regression.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute COI based on residauals of all loci against theoretical curves — compute_coi_regression","text":"list following: coi: predicted COI sample. probability: probability density function representing probability COI.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/cont_sensitivity.html","id":null,"dir":"Reference","previous_headings":"","what":"Continuous sensitivity analysis — cont_sensitivity","title":"Continuous sensitivity analysis — cont_sensitivity","text":"Runs several iterations full COI sensitivity analysis varying parameters.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/cont_sensitivity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Continuous sensitivity analysis — cont_sensitivity","text":"","code":"cont_sensitivity(   repetitions = 10,   coi = 3,   max_coi = 25,   plmaf = runif(1000, 0, 0.5),   coverage = 200,   alpha = 1,   overdispersion = 0,   relatedness = 0,   epsilon = 0,   seq_error = 0.01,   bin_size = 20,   comparison = \"overall\",   distance = \"squared\",   coi_method = \"variant\",   use_bins = FALSE )"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/cont_sensitivity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Continuous sensitivity analysis — cont_sensitivity","text":"repetitions number times sample run. coi Complexity infection. max_coi number indicating maximum COI compare simulated data . plmaf Vector population-level minor allele frequencies locus. coverage Coverage locus. single value supplied coverage applied loci. alpha Shape parameter symmetric Dirichlet prior strain proportions. overdispersion extent counts -dispersed relative binomial distribution. Counts Beta-Binomially distributed, beta distribution shape parameters \\(\\frac{p}{overdispersion}\\) \\(\\frac{1-p}{overdispersion}\\). relatedness probability strain mixed infections related another. implementation similar relatedness defined REAL McCOIL simulations. original paper defined : \"... simulated relatedness (r) among lineages within host sampling alleles either existing lineage within host (probability r) population (probability (1-r)).\" epsilon probability single read miscalled allele. error applied directions. seq_error level sequencing error assumed. value inputted, infer level sequence error. bin_size minimum size bin data. comparison method employed. One \"end\", \"ideal\", \"overall\". distance distance method used determine distance theoretical simulated curves \"overall\" method. One \"abs_sum\", \"sum_abs\", \"squared\". coi_method method use calculate theoretical COI. method either \"variant\" \"frequency\". default value \"variant\". use_bins calculate COI comparing data grouped bins changing plaf . Default = FALSE.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/cont_sensitivity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Continuous sensitivity analysis — cont_sensitivity","text":"list following: predicted_coi: dataframe predicted COIs. COIs predicted using compute_coi(). column represents separate set parameters. row represents predicted COI. Predictions done many times, depending value repetitions. probability:list matrices containing probability model predicted COI value. row contains probability different run. first row contains average probabilities runs. param_grid: parameter grid. parameter grid possible combinations parameters inputted. row represents unique combination. boot_error: dataframe containing information error algorithm. first column indicates COI fed simulation. columns indicate mean absolute error (mae), lower upper bounds 95% confidence interval bias.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/disc_sensitivity.html","id":null,"dir":"Reference","previous_headings":"","what":"Discrete Sensitivity analysis — disc_sensitivity","title":"Discrete Sensitivity analysis — disc_sensitivity","text":"Runs several iterations full COI sensitivity analysis varying parameters.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/disc_sensitivity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Discrete Sensitivity analysis — disc_sensitivity","text":"","code":"disc_sensitivity(   repetitions = 10,   coi = 3,   max_coi = 25,   plmaf = runif(1000, 0, 0.5),   coverage = 200,   alpha = 1,   overdispersion = 0,   relatedness = 0,   epsilon = 0,   seq_error = 0.01,   bin_size = 20,   comparison = \"overall\",   distance = \"squared\",   coi_method = \"variant\",   use_bins = FALSE )"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/disc_sensitivity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Discrete Sensitivity analysis — disc_sensitivity","text":"repetitions number times sample run. coi Complexity infection. max_coi number indicating maximum COI compare simulated data . plmaf Vector population-level minor allele frequencies locus. coverage Coverage locus. single value supplied coverage applied loci. alpha Shape parameter symmetric Dirichlet prior strain proportions. overdispersion extent counts -dispersed relative binomial distribution. Counts Beta-Binomially distributed, beta distribution shape parameters \\(\\frac{p}{overdispersion}\\) \\(\\frac{1-p}{overdispersion}\\). relatedness probability strain mixed infections related another. implementation similar relatedness defined REAL McCOIL simulations. original paper defined : \"... simulated relatedness (r) among lineages within host sampling alleles either existing lineage within host (probability r) population (probability (1-r)).\" epsilon probability single read miscalled allele. error applied directions. seq_error level sequencing error assumed. value inputted, infer level sequence error. bin_size minimum size bin data. comparison method employed. One \"end\", \"ideal\", \"overall\". distance distance method used determine distance theoretical simulated curves \"overall\" method. One \"abs_sum\", \"sum_abs\", \"squared\". coi_method method use calculate theoretical COI. method either \"variant\" \"frequency\". default value \"variant\". use_bins calculate COI comparing data grouped bins changing plaf . Default = FALSE.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/disc_sensitivity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Discrete Sensitivity analysis — disc_sensitivity","text":"list following: predicted_coi: dataframe predicted COIs. COIs predicted using compute_coi(). column represents separate set parameters. row represents predicted COI. Predictions done many times, depending value repetitions. probability:list matrices containing probability model predicted COI value. row contains probability different run. first row contains average probabilities runs. param_grid: parameter grid. parameter grid possible combinations parameters inputted. row represents unique combination. boot_error: dataframe containing information error algorithm. first column indicates COI fed simulation. columns indicate mean absolute error (mae), lower upper bounds 95% confidence interval bias.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/distance_curves.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute distance between two curves — distance_curves","title":"Compute distance between two curves — distance_curves","text":"Compute distance two curves using several methods. abs_sum Absolute value sum difference. sum_abs Sum absolute difference. squared Sum squared difference.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/distance_curves.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute distance between two curves — distance_curves","text":"","code":"distance_curves(processed_data, theory_cois, distance = \"squared\")"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/distance_curves.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute distance between two curves — distance_curves","text":"theory_cois theoretical COI curves. distance distance method used determine distance theoretical simulated curves \"overall\" method. One \"abs_sum\", \"sum_abs\", \"squared\".","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/distance_curves.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute distance between two curves — distance_curves","text":"list following: coi predicted COI simulation. dist distance theoretical COI simulated COI curve.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/error_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Error plot — error_plot","title":"Error plot — error_plot","text":"Creates plot showing error sensitivity analysis.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/error_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Error plot — error_plot","text":"","code":"error_plot(   data,   fill = \"coi\",   fill_levels = NULL,   title = NULL,   legend_title = fill,   legend.position = \"right\",   second_fill = NULL )"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/error_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Error plot — error_plot","text":"data data plotted. fill variable data separated . fill_levels levels fill variable. title title plot. Default NULL. legend_title text legend. Default NULL. legend.position position legend. One \"none\", \"left\", \"right\", \"bottom\", \"top\". second_fill Indicates second fill variable .","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/error_plot.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Error plot — error_plot","text":"Plots created using ggplot2::geom_col(), creates simple bar plot. mean absolute error plotted various colors, according parameter tested. addition 95% confidence interval shown black vertical lines.","code":""},{"path":[]},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/example_real_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Example real data — example_real_data","title":"Example real data — example_real_data","text":"small example dataset contains within-sample allele frequencies (WSMAFs) sample individuals.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/example_real_data.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Example real data — example_real_data","text":"matrix data. rows matrix indicate sample name columns matrix indicate WSMAF locus.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/example_real_data.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Example real data — example_real_data","text":"ftp://ngs.sanger.ac.uk/production/malaria/pfcommunityproject/Pf6/","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/likelihood.html","id":null,"dir":"Reference","previous_headings":"","what":"Likelihood of a COI — likelihood","title":"Likelihood of a COI — likelihood","text":"function generate likelihood specific COI value.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/likelihood.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Likelihood of a COI — likelihood","text":"","code":"likelihood(coi, processed_data, distance = \"squared\", coi_method = \"variant\")"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/likelihood.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Likelihood of a COI — likelihood","text":"coi COI likelihood generated. processed_data processed COI data. output process_sim() process_real(). distance distance method used determine distance theoretical simulated curves \"overall\" method. One \"abs_sum\", \"sum_abs\", \"squared\". coi_method method use calculate theoretical COI. method either \"variant\" \"frequency\". default value \"variant\".","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/likelihood.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Likelihood of a COI — likelihood","text":"likelihood specific COI value.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/likelihood.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Likelihood of a COI — likelihood","text":"likelihood can thought distance two curves: \"real\" COI curve, generated inputted data, \"simulated\" COI curve, depends COI value specified. three different methods implemented compute distance two curves: abs_sum: Absolute value sum difference. sum_abs: Sum absolute difference. squared: Sum squared difference.","code":""},{"path":[]},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/optimize_coi.html","id":null,"dir":"Reference","previous_headings":"","what":"Optimize the COI — optimize_coi","title":"Optimize the COI — optimize_coi","text":"function compute COI inputted data.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/optimize_coi.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Optimize the COI — optimize_coi","text":"","code":"optimize_coi(   data,   data_type,   max_coi = 25,   seq_error = 0.01,   bin_size = 20,   distance = \"squared\",   coi_method = \"variant\",   use_bins = FALSE )"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/optimize_coi.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Optimize the COI — optimize_coi","text":"data data COI computed. data_type type data analyzed. One \"sim\" \"real\". max_coi number indicating maximum COI compare simulated data . seq_error level sequencing error assumed. value inputted, infer level sequence error. bin_size minimum size bin data. distance distance method used determine distance theoretical simulated curves \"overall\" method. One \"abs_sum\", \"sum_abs\", \"squared\". coi_method method use calculate theoretical COI. method either \"variant\" \"frequency\". default value \"variant\". use_bins calculate COI comparing data grouped bins changing plaf . Default = FALSE.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/optimize_coi.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Optimize the COI — optimize_coi","text":"predicted COI value.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/optimize_coi.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Optimize the COI — optimize_coi","text":"function utilizes stats::optim() particular, function utilizes quasi-Newton method compute gradients build picture surface optimized. function uses likelihood function defined likelihood().","code":""},{"path":[]},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/optimize_coi_regression.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute COI based on all points fitted to best fitting curve for COI — optimize_coi_regression","title":"Compute COI based on all points fitted to best fitting curve for COI — optimize_coi_regression","text":"Compute COI based points fitted best fitting curve COI","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/optimize_coi_regression.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute COI based on all points fitted to best fitting curve for COI — optimize_coi_regression","text":"","code":"optimize_coi_regression(   data,   data_type,   max_coi = 25,   seq_error = 0.01,   distance = \"squared\",   coi_method = \"variant\",   seq_error_bin_size = 20 )"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/optimize_coi_regression.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute COI based on all points fitted to best fitting curve for COI — optimize_coi_regression","text":"data data COI computed. data_type type data analyzed. One \"sim\" \"real\". max_coi number indicating maximum COI compare simulated data . seq_error level sequencing error assumed. value inputted, infer level sequence error. distance distance method used determine distance theoretical simulated curves \"overall\" method. One \"abs_sum\", \"sum_abs\", \"squared\". coi_method method use calculate theoretical COI. method either \"variant\" \"frequency\". default value \"variant\". seq_error_bin_size Number loci smallest bin estimating sequence error","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/optimize_coi_regression.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute COI based on all points fitted to best fitting curve for COI — optimize_coi_regression","text":"predicted COI value.","code":""},{"path":[]},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/pipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipe operator — %>%","title":"Pipe operator — %>%","text":"See magrittr::%>% details.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/pipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipe operator — %>%","text":"","code":"lhs %>% rhs"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/pipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pipe operator — %>%","text":"lhs value magrittr placeholder. rhs function call using magrittr semantics.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/pipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pipe operator — %>%","text":"result calling rhs(lhs).","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/plot-simulation.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot simulated data — plot-simulation","title":"Plot simulated data — plot-simulation","text":"Generate simple plot visualizing simulated data. Compares derived WSAF PLAF.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/plot-simulation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot simulated data — plot-simulation","text":"","code":"# S3 method for sim autoplot(object, ...)  # S3 method for sim plot(x, ...)"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/plot-simulation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot simulated data — plot-simulation","text":"object, x object class sim. Derived output sim_biallelic(). ... arguments passed methods.","code":""},{"path":[]},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/plot-simulation.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot simulated data — plot-simulation","text":"","code":"plot(sim_biallelic(coi = 2))  plot(sim_biallelic(coi = 5))"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/process.html","id":null,"dir":"Reference","previous_headings":"","what":"Process data — process","title":"Process data — process","text":"Helper function process data","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/process.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Process data — process","text":"","code":"process(   wsmaf,   plmaf,   coverage,   seq_error = 0.01,   bin_size = 20,   coi_method = \"variant\" )"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/process.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Process data — process","text":"wsmaf within-sample allele frequency. plmaf population-level allele frequency. coverage read coverage locus. seq_error level sequencing error assumed. value inputted, infer level sequence error. bin_size minimum size bin data. coi_method method use calculate theoretical COI. method either \"variant\" \"frequency\". default value \"variant\".","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/process.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Process data — process","text":"list following: data: tibble plmaf_cut: Breaks form [, b). m_variant: average WSMAF proportion variant sites segment defined plmaf_cut. bucket_size: number loci bucket. midpoints: midpoint bucket. seq_error: sequence error inferred. bin_size: minimum size bin. cuts: breaks utilized splitting data. COI.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/process.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Process data — process","text":"function computes whether SNP variant site , based simulated WSMAF SNP. process additionally accounts potential sequencing error.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/process_real.html","id":null,"dir":"Reference","previous_headings":"","what":"Process real data — process_real","title":"Process real data — process_real","text":"Generate COI curve real data.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/process_real.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Process real data — process_real","text":"","code":"process_real(   wsmaf,   plmaf,   coverage,   seq_error = 0.01,   bin_size = 20,   coi_method = \"variant\" )"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/process_real.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Process real data — process_real","text":"wsmaf within-sample allele frequency. plmaf population-level allele frequency. coverage read coverage locus. seq_error level sequencing error assumed. value inputted, infer level sequence error. bin_size minimum size bin data. coi_method method use calculate theoretical COI. method either \"variant\" \"frequency\". default value \"variant\".","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/process_real.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Process real data — process_real","text":"list following: data: tibble plmaf_cut: Breaks form [, b). m_variant: average WSMAF proportion variant sites segment defined plmaf_cut. bucket_size: number loci bucket. midpoints: midpoint bucket. seq_error: sequence error inferred. bin_size: minimum size bin. cuts: breaks utilized splitting data. COI.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/process_real.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Process real data — process_real","text":"function computes whether SNP variant site , based simulated WSMAF SNP. process additionally accounts potential sequencing error.","code":""},{"path":[]},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/process_sim.html","id":null,"dir":"Reference","previous_headings":"","what":"Process simulated data — process_sim","title":"Process simulated data — process_sim","text":"Generate simulated COI curve.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/process_sim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Process simulated data — process_sim","text":"","code":"process_sim(sim, seq_error = 0.01, bin_size = 20, coi_method = \"variant\")"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/process_sim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Process simulated data — process_sim","text":"sim Output sim_biallelic(). seq_error level sequencing error assumed. value inputted, infer level sequence error. bin_size minimum size bin data. coi_method method use calculate theoretical COI. method either \"variant\" \"frequency\". default value \"variant\".","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/process_sim.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Process simulated data — process_sim","text":"list following: data: tibble plmaf_cut: Breaks form [, b). m_variant: average WSMAF proportion variant sites segment defined plmaf_cut. bucket_size: number loci bucket. midpoints: midpoint bucket. seq_error: sequence error inferred. bin_size: minimum size bin. cuts: breaks utilized splitting data. COI.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/process_sim.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Process simulated data — process_sim","text":"Utilize output sim_biallelic(), creates simulated data. PLMAF kept, function computes whether SNP variant site , based simulated WSMAF SNP. process additionally accounts potential sequencing error. check whether simulated WSMAF correctly indicated variant site , phased haplotype parasites computed.","code":""},{"path":[]},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/rbetabinom.html","id":null,"dir":"Reference","previous_headings":"","what":"Beta-binomial distribution — rbetabinom","title":"Beta-binomial distribution — rbetabinom","text":"Draw Beta-binomial distribution.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/rbetabinom.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Beta-binomial distribution — rbetabinom","text":"","code":"rbetabinom(n = 1, k = 10, alpha = 1, beta = 1)"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/rbetabinom.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Beta-binomial distribution — rbetabinom","text":"n Number draws. k Number binomial trials. alpha First shape parameter beta distribution. beta Second shape parameter beta distribution.","code":""},{"path":[]},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/rbetabinom.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Beta-binomial distribution — rbetabinom","text":"","code":"coiaf:::rbetabinom() #> [1] 9 coiaf:::rbetabinom(n = 10, k = 10) #>  [1] 4 3 2 1 5 1 5 1 0 6"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/rdirichlet.html","id":null,"dir":"Reference","previous_headings":"","what":"Dirichlet distribution — rdirichlet","title":"Dirichlet distribution — rdirichlet","text":"Draw Dirichlet distribution given vector shape parameters. number observations inferred length shape vector.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/rdirichlet.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Dirichlet distribution — rdirichlet","text":"","code":"rdirichlet(shape = rep(1, 3))"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/rdirichlet.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Dirichlet distribution — rdirichlet","text":"shape Vector shape parameters.","code":""},{"path":[]},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/rdirichlet.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Dirichlet distribution — rdirichlet","text":"","code":"coiaf:::rdirichlet(c(1, 1, 1)) #> [1] 0.31317345 0.61780718 0.06901938 coiaf:::rdirichlet(c(1, 3, 2)) #> [1] 0.4007215 0.3906395 0.2086390"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/sensitivity_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Sensitivity plot — sensitivity_plot","title":"Sensitivity plot — sensitivity_plot","text":"Creates plot sensitivity analysis.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/sensitivity_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sensitivity plot — sensitivity_plot","text":"","code":"sensitivity_plot(   data,   dims,   result_type,   sub_title = NULL,   title = NULL,   caption = NULL )"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/sensitivity_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sensitivity plot — sensitivity_plot","text":"data data plotted. dims list representing number rows columns plots split . result_type indicator indicates count boxplot plotted. sub_title list titles individual subplot. title title overall figure. caption caption overall figure.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/sensitivity_plot.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Sensitivity plot — sensitivity_plot","text":"Creates grid plots. plot created using ggplot2::geom_count(). number observations location counted count mapped point area plot. x-axis true COI, y-axis estimated COI. counts plotted blue, red line drawn equation \\(y = x\\). line indicates blue circles algorithm 100% correct.","code":""},{"path":[]},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/sensitivity_plot_element.html","id":null,"dir":"Reference","previous_headings":"","what":"Single sensitivity plot — sensitivity_plot_element","title":"Single sensitivity plot — sensitivity_plot_element","text":"Creates single plot sensitivity analysis. Used helper function sensitivity_plot().","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/sensitivity_plot_element.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Single sensitivity plot — sensitivity_plot_element","text":"","code":"sensitivity_plot_element(data, loop_num, result_type, sub_title)"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/sensitivity_plot_element.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Single sensitivity plot — sensitivity_plot_element","text":"data data plotted. loop_num loop number. Represents many total panels plotted. result_type indicator indicates count boxplot plotted. sub_title list titles individual subplot.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/sim_biallelic.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate biallelic data — sim_biallelic","title":"Simulate biallelic data — sim_biallelic","text":"Simulate biallelic data simple statistical model. Inputs include complexity infection (COI), population-level allele frequencies (PLMAF), parameters dictating skew error distributions. Outputs include phased haplotypes unphased read count coverage data.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/sim_biallelic.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate biallelic data — sim_biallelic","text":"","code":"sim_biallelic(   coi,   plmaf = runif(10, 0, 0.5),   coverage = 200,   alpha = 1,   overdispersion = 0,   relatedness = 0,   epsilon = 0 )"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/sim_biallelic.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate biallelic data — sim_biallelic","text":"coi Complexity infection. plmaf Vector population-level minor allele frequencies locus. coverage Coverage locus. single value supplied coverage applied loci. alpha Shape parameter symmetric Dirichlet prior strain proportions. overdispersion extent counts -dispersed relative binomial distribution. Counts Beta-Binomially distributed, beta distribution shape parameters \\(\\frac{p}{overdispersion}\\) \\(\\frac{1-p}{overdispersion}\\). relatedness probability strain mixed infections related another. implementation similar relatedness defined REAL McCOIL simulations. original paper defined : \"... simulated relatedness (r) among lineages within host sampling alleles either existing lineage within host (probability r) population (probability (1-r)).\" epsilon probability single read miscalled allele. error applied directions.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/sim_biallelic.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate biallelic data — sim_biallelic","text":"object class sim. Contains list tibbles: parameters contains parameter value used simulate data. strain_proportions contains proportion strain. phased_haplotypes contains phased haplotype strain locus. data contains following columns: plmaf: population-level minor allele frequency. coverage: coverage locus. counts: count locus. wsaf: within-sample minor allele frequency.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/sim_biallelic.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Simulate biallelic data — sim_biallelic","text":"Simulated data drawn simple statistical model: Strain proportions drawn symmetric Dirichlet distribution shape parameter alpha. Phased haplotypes drawn every locus, one coi. allele locus drawn Bernoulli distribution probability given plmaf. \"true\" within-sample allele frequency every locus obtained multiplying haplotypes strain proportions, summing haplotypes. Errors introduced equation \\[wsmaf_{error} = wsmaf(1-e) + (1-wsmaf)e\\] \\(wsmaf\\) WSMAF without error \\(e\\) error parameter epsilon. Final read counts drawn beta-binomial distribution expectation \\(w_{error}\\). raw number draws given coverage, skew distribution given overdispersion parameter. overdispersion equal zero, distribution binomial, rather beta-binomial.","code":""},{"path":[]},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/sim_biallelic.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate biallelic data — sim_biallelic","text":"","code":"sim_biallelic(coi = 5) #> $parameters #> # A tibble: 5 × 2 #>   parameter      value #>   <chr>          <dbl> #> 1 coi                5 #> 2 alpha              1 #> 3 overdispersion     0 #> 4 relatedness        0 #> 5 epsilon            0 #>  #> $strain_proportions #> # A tibble: 5 × 1 #>   proportion #>        <dbl> #> 1     0.0232 #> 2     0.0371 #> 3     0.479  #> 4     0.139  #> 5     0.322  #>  #> $phased_haplotypes #> # A tibble: 5 × 10 #>   locus_1 locus_2 locus_3 locus_4 locus_5 locus_6 locus_7 locus_8 locus_9 #>     <int>   <int>   <int>   <int>   <int>   <int>   <int>   <int>   <int> #> 1       1       0       0       0       0       1       1       0       0 #> 2       1       0       0       0       0       0       1       0       0 #> 3       1       0       0       1       0       1       0       1       0 #> 4       1       0       1       0       0       1       1       0       0 #> 5       0       1       0       1       0       0       0       0       0 #> # … with 1 more variable: locus_10 <int> #>  #> $data #> # A tibble: 10 × 4 #>      plmaf coverage counts wsmaf #>      <dbl>    <dbl>  <int> <dbl> #>  1 0.374        200    134 0.67  #>  2 0.170        200     68 0.34  #>  3 0.225        200     29 0.145 #>  4 0.230        200    155 0.775 #>  5 0.00665      200      0 0     #>  6 0.368        200    126 0.63  #>  7 0.493        200     40 0.2   #>  8 0.00970      200     89 0.445 #>  9 0.236        200      0 0     #> 10 0.0234       200      0 0     #>  #> attr(,\"class\") #> [1] \"sim\""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/single_sensitivity.html","id":null,"dir":"Reference","previous_headings":"","what":"Single sensitivity analysis — single_sensitivity","title":"Single sensitivity analysis — single_sensitivity","text":"Runs single full COI sensitivity analysis.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/single_sensitivity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Single sensitivity analysis — single_sensitivity","text":"","code":"single_sensitivity(   disc_or_cont,   coi = 3,   max_coi = 25,   plmaf = runif(1000, 0, 0.5),   coverage = 200,   alpha = 1,   overdispersion = 0,   relatedness = 0,   epsilon = 0,   seq_error = 0.01,   bin_size = 20,   comparison = \"overall\",   distance = \"squared\",   coi_method = \"variant\",   use_bins = FALSE )"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/single_sensitivity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Single sensitivity analysis — single_sensitivity","text":"disc_or_cont Whether run discrete continuous COI estimation. coi Complexity infection. max_coi number indicating maximum COI compare simulated data . plmaf Vector population-level minor allele frequencies locus. coverage Coverage locus. single value supplied coverage applied loci. alpha Shape parameter symmetric Dirichlet prior strain proportions. overdispersion extent counts -dispersed relative binomial distribution. Counts Beta-Binomially distributed, beta distribution shape parameters \\(\\frac{p}{overdispersion}\\) \\(\\frac{1-p}{overdispersion}\\). relatedness probability strain mixed infections related another. implementation similar relatedness defined REAL McCOIL simulations. original paper defined : \"... simulated relatedness (r) among lineages within host sampling alleles either existing lineage within host (probability r) population (probability (1-r)).\" epsilon probability single read miscalled allele. error applied directions. seq_error level sequencing error assumed. value inputted, infer level sequence error. bin_size minimum size bin data. comparison method employed. One \"end\", \"ideal\", \"overall\". distance distance method used determine distance theoretical simulated curves \"overall\" method. One \"abs_sum\", \"sum_abs\", \"squared\". coi_method method use calculate theoretical COI. method either \"variant\" \"frequency\". default value \"variant\". use_bins calculate COI comparing data grouped bins changing plaf . Default = FALSE.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/single_sensitivity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Single sensitivity analysis — single_sensitivity","text":"Predicted COI value.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/theme_coiaf.html","id":null,"dir":"Reference","previous_headings":"","what":"Custom ggplot2 theme — theme_coiaf","title":"Custom ggplot2 theme — theme_coiaf","text":"Custom ggplot2 theme","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/theme_coiaf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Custom ggplot2 theme — theme_coiaf","text":"","code":"theme_coiaf(   base_size = 10,   base_family = \"\",   base_line_size = base_size/22,   base_rect_size = base_size/22 )"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/theme_coiaf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Custom ggplot2 theme — theme_coiaf","text":"base_size base font size, given pts. base_family base font family base_line_size base size line elements base_rect_size base size rect elements","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/theme_coiaf.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Custom ggplot2 theme — theme_coiaf","text":"","code":"library(\"ggplot2\") p <- ggplot(mtcars, aes(x = wt, y = mpg, colour = factor(gear))) +   geom_point() +   facet_wrap(~am) +   geom_smooth(method = \"lm\", se = FALSE)  p + theme_coiaf() #> `geom_smooth()` using formula 'y ~ x'"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/theoretical_coi.html","id":null,"dir":"Reference","previous_headings":"","what":"Theoretical COI — theoretical_coi","title":"Theoretical COI — theoretical_coi","text":"Generate theoretical COI curves.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/theoretical_coi.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Theoretical COI — theoretical_coi","text":"","code":"theoretical_coi(   coi_range,   plmaf = seq(0, 0.5, length.out = 101),   coi_method = c(\"variant\", \"frequency\") )"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/theoretical_coi.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Theoretical COI — theoretical_coi","text":"coi_range COIs curve calculated. plmaf PLMAF curve calculated. coi_method method use calculate theoretical COI. method either \"variant\" \"frequency\". default value \"variant\".","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/theoretical_coi.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Theoretical COI — theoretical_coi","text":"theoretical COI curves specified COIs PLMAF.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/theoretical_coi.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Theoretical COI — theoretical_coi","text":"theoretical curve can visualized WSMAF individual various PLMAFs. locus, theoretical COI defined : \\[1-p^{coi}-q^{coi}\\] \\(p\\) PLMAF \\(q\\) 1 - PLMAF.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/theoretical_coi.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Theoretical COI — theoretical_coi","text":"","code":"theoretical_coi(1:5) #>     coi_1   coi_2    coi_3      coi_4      coi_5 plmaf #> 1       0 0.00000 0.000000 0.00000000 0.00000000 0.000 #> 2       0 0.00995 0.014925 0.01985050 0.02475125 0.005 #> 3       0 0.01980 0.029700 0.03940398 0.04900995 0.010 #> 4       0 0.02955 0.044325 0.05866340 0.07278350 0.015 #> 5       0 0.03920 0.058800 0.07763168 0.09607920 0.020 #> 6       0 0.04875 0.073125 0.09631172 0.11890430 0.025 #> 7       0 0.05820 0.087300 0.11470638 0.14126595 0.030 #> 8       0 0.06755 0.101325 0.13281850 0.16317125 0.035 #> 9       0 0.07680 0.115200 0.15065088 0.18462720 0.040 #> 10      0 0.08595 0.128925 0.16820630 0.20564075 0.045 #> 11      0 0.09500 0.142500 0.18548750 0.22621875 0.050 #> 12      0 0.10395 0.155925 0.20249720 0.24636800 0.055 #> 13      0 0.11280 0.169200 0.21923808 0.26609520 0.060 #> 14      0 0.12155 0.182325 0.23571280 0.28540700 0.065 #> 15      0 0.13020 0.195300 0.25192398 0.30430995 0.070 #> 16      0 0.13875 0.208125 0.26787422 0.32281055 0.075 #> 17      0 0.14720 0.220800 0.28356608 0.34091520 0.080 #> 18      0 0.15555 0.233325 0.29900210 0.35863025 0.085 #> 19      0 0.16380 0.245700 0.31418478 0.37596195 0.090 #> 20      0 0.17195 0.257925 0.32911660 0.39291650 0.095 #> 21      0 0.18000 0.270000 0.34380000 0.40950000 0.100 #> 22      0 0.18795 0.281925 0.35823740 0.42571850 0.105 #> 23      0 0.19580 0.293700 0.37243118 0.44157795 0.110 #> 24      0 0.20355 0.305325 0.38638370 0.45708425 0.115 #> 25      0 0.21120 0.316800 0.40009728 0.47224320 0.120 #> 26      0 0.21875 0.328125 0.41357422 0.48706055 0.125 #> 27      0 0.22620 0.339300 0.42681678 0.50154195 0.130 #> 28      0 0.23355 0.350325 0.43982720 0.51569300 0.135 #> 29      0 0.24080 0.361200 0.45260768 0.52951920 0.140 #> 30      0 0.24795 0.371925 0.46516040 0.54302600 0.145 #> 31      0 0.25500 0.382500 0.47748750 0.55621875 0.150 #> 32      0 0.26195 0.392925 0.48959110 0.56910275 0.155 #> 33      0 0.26880 0.403200 0.50147328 0.58168320 0.160 #> 34      0 0.27555 0.413325 0.51313610 0.59396525 0.165 #> 35      0 0.28220 0.423300 0.52458158 0.60595395 0.170 #> 36      0 0.28875 0.433125 0.53581172 0.61765430 0.175 #> 37      0 0.29520 0.442800 0.54682848 0.62907120 0.180 #> 38      0 0.30155 0.452325 0.55763380 0.64020950 0.185 #> 39      0 0.30780 0.461700 0.56822958 0.65107395 0.190 #> 40      0 0.31395 0.470925 0.57861770 0.66166925 0.195 #> 41      0 0.32000 0.480000 0.58880000 0.67200000 0.200 #> 42      0 0.32595 0.488925 0.59877830 0.68207075 0.205 #> 43      0 0.33180 0.497700 0.60855438 0.69188595 0.210 #> 44      0 0.33755 0.506325 0.61813000 0.70145000 0.215 #> 45      0 0.34320 0.514800 0.62750688 0.71076720 0.220 #> 46      0 0.34875 0.523125 0.63668672 0.71984180 0.225 #> 47      0 0.35420 0.531300 0.64567118 0.72867795 0.230 #> 48      0 0.35955 0.539325 0.65446190 0.73727975 0.235 #> 49      0 0.36480 0.547200 0.66306048 0.74565120 0.240 #> 50      0 0.36995 0.554925 0.67146850 0.75379625 0.245 #> 51      0 0.37500 0.562500 0.67968750 0.76171875 0.250 #> 52      0 0.37995 0.569925 0.68771900 0.76942250 0.255 #> 53      0 0.38480 0.577200 0.69556448 0.77691120 0.260 #> 54      0 0.38955 0.584325 0.70322540 0.78418850 0.265 #> 55      0 0.39420 0.591300 0.71070318 0.79125795 0.270 #> 56      0 0.39875 0.598125 0.71799922 0.79812305 0.275 #> 57      0 0.40320 0.604800 0.72511488 0.80478720 0.280 #> 58      0 0.40755 0.611325 0.73205150 0.81125375 0.285 #> 59      0 0.41180 0.617700 0.73881038 0.81752595 0.290 #> 60      0 0.41595 0.623925 0.74539280 0.82360700 0.295 #> 61      0 0.42000 0.630000 0.75180000 0.82950000 0.300 #> 62      0 0.42395 0.635925 0.75803320 0.83520800 0.305 #> 63      0 0.42780 0.641700 0.76409358 0.84073395 0.310 #> 64      0 0.43155 0.647325 0.76998230 0.84608075 0.315 #> 65      0 0.43520 0.652800 0.77570048 0.85125120 0.320 #> 66      0 0.43875 0.658125 0.78124922 0.85624805 0.325 #> 67      0 0.44220 0.663300 0.78662958 0.86107395 0.330 #> 68      0 0.44555 0.668325 0.79184260 0.86573150 0.335 #> 69      0 0.44880 0.673200 0.79688928 0.87022320 0.340 #> 70      0 0.45195 0.677925 0.80177060 0.87455150 0.345 #> 71      0 0.45500 0.682500 0.80648750 0.87871875 0.350 #> 72      0 0.45795 0.686925 0.81104090 0.88272725 0.355 #> 73      0 0.46080 0.691200 0.81543168 0.88657920 0.360 #> 74      0 0.46355 0.695325 0.81966070 0.89027675 0.365 #> 75      0 0.46620 0.699300 0.82372878 0.89382195 0.370 #> 76      0 0.46875 0.703125 0.82763672 0.89721680 0.375 #> 77      0 0.47120 0.706800 0.83138528 0.90046320 0.380 #> 78      0 0.47355 0.710325 0.83497520 0.90356300 0.385 #> 79      0 0.47580 0.713700 0.83840718 0.90651795 0.390 #> 80      0 0.47795 0.716925 0.84168190 0.90932975 0.395 #> 81      0 0.48000 0.720000 0.84480000 0.91200000 0.400 #> 82      0 0.48195 0.722925 0.84776210 0.91453025 0.405 #> 83      0 0.48380 0.725700 0.85056878 0.91692195 0.410 #> 84      0 0.48555 0.728325 0.85322060 0.91917650 0.415 #> 85      0 0.48720 0.730800 0.85571808 0.92129520 0.420 #> 86      0 0.48875 0.733125 0.85806172 0.92327930 0.425 #> 87      0 0.49020 0.735300 0.86025198 0.92512995 0.430 #> 88      0 0.49155 0.737325 0.86228930 0.92684825 0.435 #> 89      0 0.49280 0.739200 0.86417408 0.92843520 0.440 #> 90      0 0.49395 0.740925 0.86590670 0.92989175 0.445 #> 91      0 0.49500 0.742500 0.86748750 0.93121875 0.450 #> 92      0 0.49595 0.743925 0.86891680 0.93241700 0.455 #> 93      0 0.49680 0.745200 0.87019488 0.93348720 0.460 #> 94      0 0.49755 0.746325 0.87132200 0.93443000 0.465 #> 95      0 0.49820 0.747300 0.87229838 0.93524595 0.470 #> 96      0 0.49875 0.748125 0.87312422 0.93593555 0.475 #> 97      0 0.49920 0.748800 0.87379968 0.93649920 0.480 #> 98      0 0.49955 0.749325 0.87432490 0.93693725 0.485 #> 99      0 0.49980 0.749700 0.87469998 0.93724995 0.490 #> 100     0 0.49995 0.749925 0.87492500 0.93743750 0.495 #> 101     0 0.50000 0.750000 0.87500000 0.93750000 0.500 theoretical_coi(1:5, coi_method = \"frequency\") #>     coi_1 coi_2     coi_3     coi_4     coi_5 plmaf #> 1     NaN   NaN       NaN       NaN       NaN 0.000 #> 2     NaN   0.5 0.3350000 0.2518828 0.2020100 0.005 #> 3     NaN   0.5 0.3366667 0.2537812 0.2040402 0.010 #> 4     NaN   0.5 0.3383333 0.2556952 0.2060907 0.015 #> 5     NaN   0.5 0.3400000 0.2576247 0.2081616 0.020 #> 6     NaN   0.5 0.3416667 0.2595698 0.2102530 0.025 #> 7     NaN   0.5 0.3433333 0.2615303 0.2123652 0.030 #> 8     NaN   0.5 0.3450000 0.2635062 0.2144983 0.035 #> 9     NaN   0.5 0.3466667 0.2654976 0.2166522 0.040 #> 10    NaN   0.5 0.3483333 0.2675042 0.2188273 0.045 #> 11    NaN   0.5 0.3500000 0.2695262 0.2210236 0.050 #> 12    NaN   0.5 0.3516667 0.2715635 0.2232412 0.055 #> 13    NaN   0.5 0.3533333 0.2736160 0.2254803 0.060 #> 14    NaN   0.5 0.3550000 0.2756836 0.2277409 0.065 #> 15    NaN   0.5 0.3566667 0.2777663 0.2300231 0.070 #> 16    NaN   0.5 0.3583333 0.2798640 0.2323271 0.075 #> 17    NaN   0.5 0.3600000 0.2819767 0.2346528 0.080 #> 18    NaN   0.5 0.3616667 0.2841044 0.2370005 0.085 #> 19    NaN   0.5 0.3633333 0.2862468 0.2393702 0.090 #> 20    NaN   0.5 0.3650000 0.2884040 0.2417620 0.095 #> 21    NaN   0.5 0.3666667 0.2905759 0.2441758 0.100 #> 22    NaN   0.5 0.3683333 0.2927624 0.2466119 0.105 #> 23    NaN   0.5 0.3700000 0.2949635 0.2490702 0.110 #> 24    NaN   0.5 0.3716667 0.2971789 0.2515508 0.115 #> 25    NaN   0.5 0.3733333 0.2994088 0.2540537 0.120 #> 26    NaN   0.5 0.3750000 0.3016529 0.2565789 0.125 #> 27    NaN   0.5 0.3766667 0.3039112 0.2591266 0.130 #> 28    NaN   0.5 0.3783333 0.3061835 0.2616967 0.135 #> 29    NaN   0.5 0.3800000 0.3084699 0.2642892 0.140 #> 30    NaN   0.5 0.3816667 0.3107701 0.2669042 0.145 #> 31    NaN   0.5 0.3833333 0.3130841 0.2695415 0.150 #> 32    NaN   0.5 0.3850000 0.3154118 0.2722013 0.155 #> 33    NaN   0.5 0.3866667 0.3177530 0.2748835 0.160 #> 34    NaN   0.5 0.3883333 0.3201077 0.2775881 0.165 #> 35    NaN   0.5 0.3900000 0.3224757 0.2803151 0.170 #> 36    NaN   0.5 0.3916667 0.3248569 0.2830643 0.175 #> 37    NaN   0.5 0.3933333 0.3272511 0.2858358 0.180 #> 38    NaN   0.5 0.3950000 0.3296584 0.2886294 0.185 #> 39    NaN   0.5 0.3966667 0.3320784 0.2914452 0.190 #> 40    NaN   0.5 0.3983333 0.3345112 0.2942831 0.195 #> 41    NaN   0.5 0.4000000 0.3369565 0.2971429 0.200 #> 42    NaN   0.5 0.4016667 0.3394143 0.3000245 0.205 #> 43    NaN   0.5 0.4033333 0.3418843 0.3029279 0.210 #> 44    NaN   0.5 0.4050000 0.3443665 0.3058530 0.215 #> 45    NaN   0.5 0.4066667 0.3468606 0.3087996 0.220 #> 46    NaN   0.5 0.4083333 0.3493667 0.3117676 0.225 #> 47    NaN   0.5 0.4100000 0.3518844 0.3147568 0.230 #> 48    NaN   0.5 0.4116667 0.3544136 0.3177672 0.235 #> 49    NaN   0.5 0.4133333 0.3569542 0.3207984 0.240 #> 50    NaN   0.5 0.4150000 0.3595061 0.3238505 0.245 #> 51    NaN   0.5 0.4166667 0.3620690 0.3269231 0.250 #> 52    NaN   0.5 0.4183333 0.3646428 0.3300161 0.255 #> 53    NaN   0.5 0.4200000 0.3672273 0.3331293 0.260 #> 54    NaN   0.5 0.4216667 0.3698223 0.3362624 0.265 #> 55    NaN   0.5 0.4233333 0.3724278 0.3394154 0.270 #> 56    NaN   0.5 0.4250000 0.3750434 0.3425878 0.275 #> 57    NaN   0.5 0.4266667 0.3776690 0.3457796 0.280 #> 58    NaN   0.5 0.4283333 0.3803045 0.3489903 0.285 #> 59    NaN   0.5 0.4300000 0.3829497 0.3522199 0.290 #> 60    NaN   0.5 0.4316667 0.3856043 0.3554679 0.295 #> 61    NaN   0.5 0.4333333 0.3882682 0.3587342 0.300 #> 62    NaN   0.5 0.4350000 0.3909411 0.3620184 0.305 #> 63    NaN   0.5 0.4366667 0.3936230 0.3653202 0.310 #> 64    NaN   0.5 0.4383333 0.3963135 0.3686393 0.315 #> 65    NaN   0.5 0.4400000 0.3990126 0.3719755 0.320 #> 66    NaN   0.5 0.4416667 0.4017199 0.3753283 0.325 #> 67    NaN   0.5 0.4433333 0.4044353 0.3786974 0.330 #> 68    NaN   0.5 0.4450000 0.4071586 0.3820825 0.335 #> 69    NaN   0.5 0.4466667 0.4098896 0.3854832 0.340 #> 70    NaN   0.5 0.4483333 0.4126281 0.3888992 0.345 #> 71    NaN   0.5 0.4500000 0.4153738 0.3923301 0.350 #> 72    NaN   0.5 0.4516667 0.4181265 0.3957755 0.355 #> 73    NaN   0.5 0.4533333 0.4208861 0.3992349 0.360 #> 74    NaN   0.5 0.4550000 0.4236523 0.4027081 0.365 #> 75    NaN   0.5 0.4566667 0.4264248 0.4061945 0.370 #> 76    NaN   0.5 0.4583333 0.4292035 0.4096939 0.375 #> 77    NaN   0.5 0.4600000 0.4319882 0.4132057 0.380 #> 78    NaN   0.5 0.4616667 0.4347786 0.4167294 0.385 #> 79    NaN   0.5 0.4633333 0.4375745 0.4202648 0.390 #> 80    NaN   0.5 0.4650000 0.4403756 0.4238113 0.395 #> 81    NaN   0.5 0.4666667 0.4431818 0.4273684 0.400 #> 82    NaN   0.5 0.4683333 0.4459928 0.4309358 0.405 #> 83    NaN   0.5 0.4700000 0.4488084 0.4345129 0.410 #> 84    NaN   0.5 0.4716667 0.4516283 0.4380992 0.415 #> 85    NaN   0.5 0.4733333 0.4544523 0.4416943 0.420 #> 86    NaN   0.5 0.4750000 0.4572802 0.4452978 0.425 #> 87    NaN   0.5 0.4766667 0.4601117 0.4489090 0.430 #> 88    NaN   0.5 0.4783333 0.4629466 0.4525275 0.435 #> 89    NaN   0.5 0.4800000 0.4657847 0.4561529 0.440 #> 90    NaN   0.5 0.4816667 0.4686257 0.4597845 0.445 #> 91    NaN   0.5 0.4833333 0.4714693 0.4634219 0.450 #> 92    NaN   0.5 0.4850000 0.4743154 0.4670646 0.455 #> 93    NaN   0.5 0.4866667 0.4771637 0.4707121 0.460 #> 94    NaN   0.5 0.4883333 0.4800140 0.4743638 0.465 #> 95    NaN   0.5 0.4900000 0.4828660 0.4780192 0.470 #> 96    NaN   0.5 0.4916667 0.4857194 0.4816778 0.475 #> 97    NaN   0.5 0.4933333 0.4885740 0.4853390 0.480 #> 98    NaN   0.5 0.4950000 0.4914297 0.4890024 0.485 #> 99    NaN   0.5 0.4966667 0.4942860 0.4926674 0.490 #> 100   NaN   0.5 0.4983333 0.4971429 0.4963334 0.495 #> 101   NaN   0.5 0.5000000 0.5000000 0.5000000 0.500"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/tidyeval.html","id":null,"dir":"Reference","previous_headings":"","what":"Tidy eval helpers — tidyeval","title":"Tidy eval helpers — tidyeval","text":"page lists tidy eval tools reexported package rlang. learn using tidy eval scripts packages high level, see dplyr programming vignette ggplot2 packages vignette. Metaprogramming section Advanced R may also useful deeper dive. tidy eval operators {{, !!, !!! syntactic constructs specially interpreted tidy eval functions. mostly need {{, !! !!! advanced operators use simple cases. curly-curly operator {{ allows tunnel data-variables passed function arguments inside tidy eval functions. {{ designed individual arguments. pass multiple arguments contained dots, use ... normal way. enquo() enquos() delay execution one several function arguments. former returns single expression, latter returns list expressions. defused, expressions longer evaluate . must injected back evaluation context !! (single expression) !!! (list expressions). simple case, code equivalent usage {{ ... . Defusing enquo() enquos() needed complex cases, instance need inspect modify expressions way. .data pronoun object represents current slice data. variable name string, use .data pronoun subset variable [[. Another tidy eval operator :=. makes possible use glue curly-curly syntax LHS =. technical reasons, R language support complex expressions left =, use := workaround. Many tidy eval functions like dplyr::mutate() dplyr::summarise() give automatic name unnamed inputs. need create sort automatic names , use as_label(). instance, glue-tunnelling syntax can reproduced manually : Expressions defused enquo() (tunnelled {{) need simple column names, can arbitrarily complex. as_label() handles cases gracefully. code assumes simple column name, use as_name() instead. safer throws error input name expected.","code":"my_function <- function(data, var, ...) {   data %>%     group_by(...) %>%     summarise(mean = mean({{ var }})) } my_function <- function(data, var, ...) {   # Defuse   var <- enquo(var)   dots <- enquos(...)    # Inject   data %>%     group_by(!!!dots) %>%     summarise(mean = mean(!!var)) } my_var <- \"disp\" mtcars %>% summarise(mean = mean(.data[[my_var]])) my_function <- function(data, var, suffix = \"foo\") {   # Use `{{` to tunnel function arguments and the usual glue   # operator `{` to interpolate plain strings.   data %>%     summarise(\"{{ var }}_mean_{suffix}\" := mean({{ var }})) } my_function <- function(data, var, suffix = \"foo\") {   var <- enquo(var)   prefix <- as_label(var)   data %>%     summarise(\"{prefix}_mean_{suffix}\" := mean(!!var)) }"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/world_map.html","id":null,"dir":"Reference","previous_headings":"","what":"World map plot — world_map","title":"World map plot — world_map","text":"Plot world map showing COI region reads sampled .","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/world_map.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"World map plot — world_map","text":"","code":"world_map(data, variable, label = NULL, alpha = 0.1, breaks = c(1, 2))"},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/world_map.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"World map plot — world_map","text":"data data plotted. variable variable data plot. label label variable. alpha alpha value plotted data. breaks breaks color scale.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/reference/world_map.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"World map plot — world_map","text":"Creates world map overlays COI region. magnitude COI indicated color size bubble.","code":""},{"path":[]},{"path":[]},{"path":"https://bailey-lab.github.io/coiaf/dev/news/index.html","id":"new-vignettes-development-version","dir":"Changelog","previous_headings":"","what":"New vignettes","title":"coiaf (development version)","text":"New vignette(\"example_real_data\") illustrates use package real data sets. New vignette(\"sensitivity_analysis_discrete\") describes sensitivity analysis discrete methods. New vignette(\"sensitivity_analysis_continuous\") describes sensitivity analysis continuous methods. New vignette(\"example_coi_prediction\") explains internal prediction methods. New vignette(\"example_simulation\") explains data simulated.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/news/index.html","id":"new-features-development-version","dir":"Changelog","previous_headings":"","what":"New features","title":"coiaf (development version)","text":"autoplot plot method written simulated data (#22). Simulated data restructured now assigned class sim (#22). default sequence error threshold set 1%. methods now can estimate COI without grouping data points buckets (#17). Within sample minor allele frequencies now weighed read coverage. coverage supplied, coverage assumed uniform across loci (#16.) New theme_coiaf() creates custom theme package.","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/news/index.html","id":"bug-fixes-development-version","dir":"Changelog","previous_headings":"","what":"Bug Fixes","title":"coiaf (development version)","text":"Midpoint calculation buckets improved. Previously, buckets consisted single value, combine bucket another bucket. longer let buckets consist single value (#19). estimation methods, bucket now weighed number points bucket (#15). Frequency Method undefined COI less two. suspect COI less two, return NaN. additionally return note indicating COI may one. able compute COI, also return COI estimated methods (#14, #21, #23).","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/news/index.html","id":"maintenance-development-version","dir":"Changelog","previous_headings":"","what":"Maintenance","title":"coiaf (development version)","text":"PLAF renamed PLMAF indicate focus minor allele. WSAF renamed WSMAF indicate focus minor allele. Fix partial argument match warnings. Update license year. number dependencies reduced. patchwork used instead ggpubr combining plots. rlang now used messages, warnings, errors. Superseded functions replaced alternatives (#6). Functions now exit implicitly visibly (#8). Internal documentation improved. COI methods renamed improved clarity. \"Method 1\" renamed \"Variant Method\" \"Method 2\" renamed \"Frequency Method\" (#9).","code":""},{"path":"https://bailey-lab.github.io/coiaf/dev/news/index.html","id":"coiaf-010","dir":"Changelog","previous_headings":"","what":"coiaf 0.1.0","title":"coiaf 0.1.0","text":"Initial public release.","code":""}]
